<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Word、PHPWord'>
<meta name="keywords" content="PHPWord"><title>PHPWord</title>

<link rel='canonical' href='http://localhost:1313/phpword/'>

<link rel="stylesheet" href="/scss/style.min.83fdf04f357d6c514ee15e600463b045549e8b40c428f14454adecaa742b352f.css"><meta property='og:title' content='PHPWord'>
<meta property='og:description' content='Word、PHPWord'>
<meta property='og:url' content='http://localhost:1313/phpword/'>
<meta property='og:site_name' content=''>
<meta property='og:type' content='article'><meta property='article:section' content='Technology' /><meta property='article:published_time' content='2023-11-30T11:30:00&#43;08:00'/><meta property='article:modified_time' content='2023-11-30T11:30:00&#43;08:00'/><meta property='og:image' content='http://localhost:1313/phpword/img/logo/PHPWord.png' />
<meta name="twitter:title" content="PHPWord">
<meta name="twitter:description" content="Word、PHPWord"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='http://localhost:1313/phpword/img/logo/PHPWord.png' />
  


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column compact"><aside class="sidebar left-sidebar sticky compact">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="切换菜单">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hud0562191972c102080634509deeb4fad_2886644_300x0_resize_mitchellnetravali_3.png" width="300"
                            height="400" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        

        <div class="site-meta">
            <h1 class="site-name"><a href="/"></a></h1>
            <h2 class="site-description"></h2>
        </div>
    </header><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                <span>首页</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                <span>分类</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about/' >
                
                
                
                <span>关于</span>
            </a>
        </li>
        
        
        <li >
            <a href='/contact/' >
                
                
                
                <span>联系</span>
            </a>
        </li>
        
        
        <li >
            <a href='/categories/technology/' >
                
                
                
                <span>技术</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
                <li id="i18n-switch">  
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                    <select name="language" onchange="window.location.href = this.selectedOptions[0].value">
                        
                            <option value="http://localhost:1313/" selected></option>
                        
                    </select>
                </li>
            
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>暗色模式</span>
                </li>
            
        </div>
    </ol>
</aside>

    

            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/phpword/">
                <img src="/phpword/img/logo/PHPWord_hu9c9285c7f385c9c140d2c3fa4e18b6e6_58659_800x0_resize_mitchellnetravali_3.png"
                        srcset="/phpword/img/logo/PHPWord_hu9c9285c7f385c9c140d2c3fa4e18b6e6_58659_800x0_resize_mitchellnetravali_3.png 800w, /phpword/img/logo/PHPWord_hu9c9285c7f385c9c140d2c3fa4e18b6e6_58659_1600x0_resize_mitchellnetravali_3.png 1600w"
                        width="800" 
                        height="96" 
                        loading="lazy"
                        alt="Featured image of post PHPWord" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/technology/" >
                Technology
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/phpword/">PHPWord</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            Word、PHPWord
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Nov 30, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    阅读时长: 28 分钟
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="简介">简介</h2>
<p><a class="link" href="https://phpword-zh.readthedocs.io/zh-cn/latest/intro.html"  title="PHPWord"
     target="_blank" rel="noopener"
    >PHPWord</a>是一个用于在 PHP 中生成和操作 Microsoft Word 文档的库，它允许开发人员通过 PHP 脚本创建、编辑和操作 Word 文档，包括添加文本、表格、图像、样式、页眉、页脚、超链接等元素。PHPWord 是一个强大的工具，可用于自动生成报告、合同、文档、信函以及其他 Word 文档类型。</p>
<p>以下是 PHPWord 提供的一些主要功能：</p>
<ul>
<li>创建 Word 文档：您可以使用 PHPWord 创建新的 Word 文档，设置文档的结构、样式和内容。</li>
<li>编辑和修改文档：您可以打开现有的 Word 文档并进行编辑，包括插入、删除和修改文本、表格和其他元素。</li>
<li>格式设置：PHPWord 允许您设置文本、段落、表格等的样式和格式，如字体、颜色、大小、对齐方式等。</li>
<li>添加表格：您可以轻松添加和格式化表格，包括单元格合并和拆分等功能。</li>
<li>插入图像：您可以将图像插入文档，并设置它们的位置、大小和样式。</li>
<li>页眉和页脚：您可以在文档的页眉和页脚中添加文本、页码、日期等信息。</li>
<li>超链接：PHPWord 支持创建超链接，以连接到其他部分的文档、外部链接等。</li>
<li>图形：插入绘图形状（圆弧、曲线、直线、折线、矩形、椭圆形）、图表（饼图、圆环图、条形图、折线图、面积图、散点图、雷达图）</li>
<li>表单字段：插入表单字段（文本输入、复选框和下拉列表）</li>
<li>导出为不同格式：生成的 Word 文档可以导出为不同格式，如 DOCX、PDF 等。</li>
</ul>
<p>PHPWord 使 PHP 开发人员能够动态生成和处理 Word 文档，这在需要自动生成大量文档或需要自动化文档生成过程的应用程序中非常有用。它是一个开源项目，可以通过 Composer 轻松安装和集成到 PHP 项目中。</p>
<blockquote>
<p>OOXML、ODF 和 RTF是三种不同的文档格式标准：</p>
<p>OOXML（Office Open XML）：OOXML是由Microsoft开发的一种开放文档标准，用于表示和存储Microsoft Office文档（如.docx、.xlsx、.pptx等）。它基于XML（可扩展标记语言）格式，并使用ZIP压缩进行打包。OOXML标准经过国际标准化组织（ISO）的认可，目前被广泛支持和采用。</p>
<p>ODF（Open Document Format）：ODF是一种开放文档标准，由OASIS（Organization for the Advancement of Structured Information Standards）制定，用于表示和存储各种办公套件（如LibreOffice、Apache OpenOffice等）创建的文档。ODF使用XML格式，并支持多种文档类型，包括文本文档、电子表格、演示文稿等。ODF标准也获得了ISO的认可，并在开源办公套件中得到广泛应用。</p>
<p>RTF（Rich Text Format）：RTF是一种通用的文本格式，用于交换和共享文本文档。RTF最初由Microsoft开发，但现在已成为一种跨平台的标准格式。RTF文件包含文本内容、格式化信息和控制指令，可以在不同的文本编辑器和办公套件之间进行互操作性。</p>
</blockquote>
<h2 id="安装配置快速入门">安装、配置、快速入门</h2>
<h3 id="依赖">依赖</h3>
<ul>
<li>PHP 7.1+</li>
<li><a class="link" href="http://www.php.net/manual/en/xml.installation.php"  title="XML Parser extension"
     target="_blank" rel="noopener"
    >XML Parser extension</a></li>
<li><a class="link" href="https://docs.laminas.dev/laminas-escaper/intro/"  title="Laminas Escaper component"
     target="_blank" rel="noopener"
    >Laminas Escaper component</a>【转义HTML标签、JS、Css 与 URL】</li>
<li><a class="link" href="http://php.net/manual/en/book.zip.php"  title="Zip extension"
     target="_blank" rel="noopener"
    >Zip extension</a>【optional, used to write OOXML and ODF】</li>
<li><a class="link" href="http://php.net/manual/en/book.image.php"  title="GD extension"
     target="_blank" rel="noopener"
    >GD extension</a>【optional, used to add images】</li>
<li><a class="link" href="http://php.net/manual/en/book.xmlwriter.php"  title="XMLWriter extension"
     target="_blank" rel="noopener"
    >XMLWriter extension</a>【optional, used to write OOXML and ODF】</li>
<li><a class="link" href="http://php.net/manual/en/book.xsl.php"  title="XSL extension"
     target="_blank" rel="noopener"
    >XSL extension</a>(optional, used to apply XSL style sheet to template )【XSL扩展实现了XSL标准，使用libxslt库执行XSLT转换】</li>
<li><a class="link" href="https://github.com/dompdf/dompdf"  title="dompdf library"
     target="_blank" rel="noopener"
    >dompdf library</a>【optional, used to write PDF】</li>
</ul>
<blockquote>
<p>XSL(Extensible Stylesheet Language) 是一种 用于 定义 和 转换 XML 文档的语言，主要用途是 将 XML 数据 转换为 其他格式 如 HTML、PDF 或 纯文本，以 实现数据的展示和呈现。它可以根据 特定的 规则 和 样式表 将 XML 数据进行转换、筛选、排序 和 格式化。</p>
</blockquote>
<h3 id="安装方式">安装方式</h3>
<p>方式一：Composer 安装</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#78787e">// composer.json 中
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>{
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;require&#34;</span><span style="color:#ff6ac1">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#34;phpoffice/phpword&#34;</span><span style="color:#ff6ac1">:</span> <span style="color:#5af78e">&#34;dev-master&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 命令
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>composer <span style="color:#ff6ac1">require</span> phpoffice<span style="color:#ff6ac1">/</span>phpword
</span></span></code></pre></div><p>方式二：手动安装</p>
<ul>
<li><a class="link" href="https://github.com/PHPOffice/PHPWord/archive/master.zip"  title="手动下载 PHPOffice\PHPWord 包"
     target="_blank" rel="noopener"
    >手动下载 PHPOffice\PHPWord 包</a></li>
<li><a class="link" href="https://github.com/PHPOffice/Common/archive/master.zip"  title="手动下载 PHPOffice\Common 包"
     target="_blank" rel="noopener"
    >手动下载 PHPOffice\Common 包</a></li>
<li>解压 放入 项目 依赖中</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff6ac1">&lt;?</span>php
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">require_once</span> <span style="color:#5af78e">&#39;path/to/PHPWord/src/PhpWord/Autoloader.php&#39;</span>;
</span></span><span style="display:flex;"><span>\PhpOffice\PhpWord\Autoloader<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">register</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">require_once</span> <span style="color:#5af78e">&#39;path/to/PhpOffice/Common/src/Common/Autoloader.php&#39;</span>;
</span></span><span style="display:flex;"><span>\PhpOffice\Common\Autoloader<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">register</span>();
</span></span></code></pre></div><blockquote>
<p>安装后，您可以通过命令行或使用浏览器浏览和使用我们提供的示例。
如果您可以使用浏览器访问 PhpWord 库文件夹，请将浏览器指向 samples 文件夹，例如http://localhost/PhpWord/samples/</p>
</blockquote>
<h3 id="快速入门">快速入门</h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff5c57">$phpWord</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">new</span> PhpWord();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 添加一个片段
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addSection</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 给 片段中 添加一些文本内容
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;php 是世界上最好的语言!&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#5af78e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"> * 注意：您可以以三种方式自定义添加的Text元素的字体样式：
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"> * inline
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"> * 使用命名的字体样式（将隐式创建新的字体样式对象）;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"> * 使用显式创建的字体样式对象。
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"> */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// inline 方式
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;通过第二参数指定 Text 的 字体 类型与大小&#39;</span>,[<span style="color:#5af78e">&#39;name&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;Tahoma&#39;</span>,<span style="color:#5af78e">&#39;size&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">10</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 使用命名字体样式自定义字体样式添加Text元素
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$fontStyleName</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#39;sttDefinedFontStyle&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addFontStyle</span>(<span style="color:#ff5c57">$fontStyleName</span>, [<span style="color:#5af78e">&#39;name&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;Tahoma&#39;</span>, <span style="color:#5af78e">&#39;size&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">10</span>, <span style="color:#5af78e">&#39;color&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;1B2232&#39;</span>, <span style="color:#5af78e">&#39;bold&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>]);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;&#34;最伟大的成就不在于从不倒下，而在于跌倒后再次站起来。&#34;（文斯·隆巴迪）&#39;</span>, <span style="color:#ff5c57">$fontStyleName</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 使用显式创建的字体样式对象自定义字体样式添加Text元素...
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$fontStyle</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">new</span> \PhpOffice\PhpWord\Style\Font();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$fontStyle</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setBold</span>(<span style="color:#ff6ac1">true</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setName</span>(<span style="color:#5af78e">&#39;Tahoma&#39;</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setSize</span>(<span style="color:#ff9f43">13</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;&#34;相信你能行，你已经成功了一半。&#34;（西奥多·罗斯福）&#39;</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setFontStyle</span>(<span style="color:#ff5c57">$fontStyle</span>);
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#78787e">// 将文档保存为OOXML文件（.docx）...
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$objWriter</span> <span style="color:#ff6ac1">=</span> \PhpOffice\PhpWord\IOFactory<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">createWriter</span>(<span style="color:#ff5c57">$phpWord</span>, <span style="color:#5af78e">&#39;Word2007&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$objWriter</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">save</span>(<span style="color:#5af78e">&#39;helloWorld.docx&#39;</span>);
</span></span></code></pre></div><p><img src="/phpword/img/phpword_dox.png"
	width="906"
	height="194"
	srcset="/phpword/img/phpword_dox_hu08ea287395593b10941f28421ae24c65_15964_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/phpword_dox_hu08ea287395593b10941f28421ae24c65_15964_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="PHPWord Output dox"
	
	
		class="gallery-image" 
		data-flex-grow="467"
		data-flex-basis="1120px"
	
></p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#78787e">// 将文档保存为ODF文件（.odt）...
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$objWriter</span> <span style="color:#ff6ac1">=</span> \PhpOffice\PhpWord\IOFactory<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">createWriter</span>(<span style="color:#ff5c57">$phpWord</span>, <span style="color:#5af78e">&#39;ODText&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$objWriter</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">save</span>(<span style="color:#5af78e">&#39;helloWorld.odt&#39;</span>);
</span></span></code></pre></div><p><img src="/phpword/img/phpword_odt.png"
	width="991"
	height="229"
	srcset="/phpword/img/phpword_odt_hu9254c47e3036a885bb1e2d6bc6859ded_24201_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/phpword_odt_hu9254c47e3036a885bb1e2d6bc6859ded_24201_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="PHPWord Output odt"
	
	
		class="gallery-image" 
		data-flex-grow="432"
		data-flex-basis="1038px"
	
></p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#78787e">// 将文档保存为HTML文件...
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$objWriter</span> <span style="color:#ff6ac1">=</span> \PhpOffice\PhpWord\IOFactory<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">createWriter</span>(<span style="color:#ff5c57">$phpWord</span>, <span style="color:#5af78e">&#39;HTML&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$objWriter</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">save</span>(<span style="color:#5af78e">&#39;helloWorld.html&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">/*</span> 注意：我们跳过RTF，因为它不基于XML，需要使用不同的示例。 <span style="color:#ff6ac1">/</span>
</span></span></code></pre></div><p><img src="/phpword/img/phpword_html.png"
	width="843"
	height="159"
	srcset="/phpword/img/phpword_html_hube011d75f47dc884998772a5805f0f89_21948_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/phpword_html_hube011d75f47dc884998772a5805f0f89_21948_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="PHPWord Output html"
	
	
		class="gallery-image" 
		data-flex-grow="530"
		data-flex-basis="1272px"
	
></p>
<h3 id="文档配置">文档配置</h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>配置项</th>
<th>参数</th>
<th>类型</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>XML</td>
<td><br><br><br>Writer兼容性\PhpOffice\PhpWord\Settings::setCompatibility(false);</td>
<td><br><br><br>bool</td>
<td>此选项设置 XMLWriter::setIndent和 XMLWriter::setIndentString。该选项的默认值为 true（兼容），这对于 OpenOffice 正确渲染 OOXML 文档是必需的。<br>在开发过程中，您可以将此选项设置为false，以便生成的XML文件更易于阅读。 <br> 注意：此处的&quot;OOXML&quot;指的是Office Open XML，即Microsoft Office的文档格式。</td>
</tr>
<tr>
<td>Zip 类</td>
<td>\PhpOffice\PhpWord\Settings::setZipClass(\PhpOffice\PhpWord\Settings::PCLZIP);</td>
<td>string</td>
<td>如果服务器没有安装 zip 扩展 则 使用 php 的 pclzip 扩展</td>
</tr>
<tr>
<td>输出转义</td>
<td><br><br><br>\PhpOffice\PhpWord\Settings::setOutputEscapingEnabled(true);</td>
<td><br><br><br>bool</td>
<td>此选项设置是否启用输出转义。默认情况下，内置转义机制在v0.13.0之前的版本中被禁用，要启用内置转义机制，请在您的PHPWord配置文件中将outputEscapingEnabled选项设置为true。</td>
</tr>
<tr>
<td>默认纸张</td>
<td>\PhpOffice\PhpWord\Settings::setDefaultPaper(&lsquo;Letter&rsquo;);</td>
<td>string</td>
<td>默认情况下，文档的所有节都将使用A4纸打印，可通过该代码将纸张设为 Letter 纸张</td>
</tr>
<tr>
<td>设置默认字体 与 大小</td>
<td><br>$phpWord-&gt;setDefaultFontName(&lsquo;Times New Roman&rsquo;);<br>$phpWord-&gt;setDefaultFontSize(12);</td>
<td><br>string</td>
<td>默认情况下，所有文本以Arial字体，10号字体大小显示，您可以使用这两个函数来更改默认字体</td>
</tr>
</tbody>
</table></div>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff5c57">$output</span> <span style="color:#ff6ac1">=</span> Env<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">get</span>(<span style="color:#5af78e">&#39;root_path&#39;</span>) <span style="color:#ff6ac1">.</span> <span style="color:#5af78e">&#39;public/static/file/setting.docx&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Settings<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">setCompatibility</span>(<span style="color:#ff6ac1">false</span>);      <span style="color:#78787e">// 开发过程中 可 设为 false 使生成的 XML 文件更易读
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>Settings<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">setZipClass</span>(Settings<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">PCLZIP</span>);    <span style="color:#78787e">// 如果 服务器 没有安装 zip 扩展 则 使用 php 的 pclzip 扩展
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>Settings<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">setOutputEscapingEnabled</span>(<span style="color:#ff6ac1">true</span>);   <span style="color:#78787e">// 是否启用 内置转义 以确保 &amp; 等 特殊字符能正确显示
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>Settings<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">setDefaultPaper</span>(<span style="color:#5af78e">&#39;A4&#39;</span>);                <span style="color:#78787e">// 设置默认纸张大小
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>Settings<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">setDefaultFontName</span>(<span style="color:#5af78e">&#39;Times New Roman&#39;</span>);    <span style="color:#78787e">// 设置默认字体
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>Settings<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">setDefaultFontSize</span>(<span style="color:#ff9f43">12</span>);           <span style="color:#78787e">// 设置字体大小
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$phpWord</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">new</span> PhpWord();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 1) 修改 文档 默认配置
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$settings</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getSettings</span>();
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 设置文档保护级别：none =&gt; 无、readOnly =&gt; 只读、comments =&gt; 允许 添加/修改 注释 但 无法修改文本内容
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// trackedChanges =&gt; 允许添加 和 接受修订 更改 但 无法直接编辑文本内容
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// forms =&gt; 允许 填写 和 交互式 使用 表单 字段， 但 无法修改文本内容
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// $settings-&gt;setDocumentProtection((new Protection())-&gt;setEditing(DocProtect::READ_ONLY)-&gt;setPassword(&#39;shentongtong&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// 是否 对文档 的 拼写和语法 启用 校对 功能【标记为 DIRTY 打开文档时 会强制重新检查】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$settings</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setProofState</span>((<span style="color:#ff6ac1">new</span> ProofState())<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setSpelling</span>(ProofState<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">DIRTY</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setGrammar</span>(ProofState<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">DIRTY</span>));
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 是否 隐藏 错误标记 和 提示
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$settings</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setHideSpellingErrors</span>(<span style="color:#ff6ac1">false</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 是否 隐藏 语法错误标记和提示
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$settings</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setHideGrammaticalErrors</span>(<span style="color:#ff6ac1">false</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 设置文档的 修订、查看 模式
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// setInsDel =&gt; 设置是否显示内容修订
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// setComments =&gt; 是否显示注释
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// setMarkup =&gt; 显示文档的修订更改，以标记的形式显示添加、删除和修改的内容
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// setFormatting =&gt; 设置是否显示格式修订
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// setInkAnnotations =&gt; 设置是否显示墨迹批注
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$settings</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setRevisionView</span>((<span style="color:#ff6ac1">new</span> TrackChangesView())<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setMark</span>(<span style="color:#ff6ac1">true</span>));
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 是否启用 文档的 修订跟踪 功能
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$settings</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setTrackRevisions</span>(<span style="color:#ff6ac1">true</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 会否启用 跟踪文档的移动操作，例如 剪切、粘贴【默认 为 false 启用】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$settings</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setDoNotTrackMoves</span>(<span style="color:#ff6ac1">false</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 是否启用 不跟踪格式化更改【格式化更改 =&gt; 对文本样式、字体、段落格式等进行的更改操作，默认为 false 启用】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$settings</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setDoNotTrackFormatting</span>(<span style="color:#ff6ac1">false</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 修改文档默认语言
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$settings</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setThemeFontLang</span>(<span style="color:#ff6ac1">new</span> Language(Language<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">ZH_CN</span>));
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 设置 文档 打印时 的 缩放级别【默认100 =&gt; 原始比例、200 =&gt; 放大两倍、80 =&gt; 原文档比例的80%】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$settings</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setZoom</span>(Zoom<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">BEST_FIT</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 是否启用 镜像页边距【互换左右页边距、默认为false不启用】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$settings</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setMirrorMargins</span>(<span style="color:#ff6ac1">false</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 设置是否 启用文档字段自动更新【默认为 false 不启用】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// 字段是文档中的特殊标记，可以包含动态内容或引用其他部分的信息，常见字段有 日期、页码、目录等
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$settings</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setUpdateFields</span>(<span style="color:#ff6ac1">true</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 设置文档中 代表 小数点 的 符号
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$settings</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setDecimalSymbol</span>(<span style="color:#5af78e">&#39;.&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 设置是否启用自动断词，自动断词是指在文档中自动将单词分割成连字符形式以适应页面布局，以防止单词溢出到下一行
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$settings</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setHyphenationZone</span>(<span style="color:#ff6ac1">true</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 设置 遇到 大写字母 时 是否断词
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$settings</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setDoNotHyphenateCaps</span>(<span style="color:#ff6ac1">false</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 2) 修改 文件信息
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$properties</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getDocInfo</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$properties</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setCreator</span>(<span style="color:#5af78e">&#39;申通通&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$properties</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setCompany</span>(<span style="color:#5af78e">&#39;英才网联&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$properties</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setTitle</span>(<span style="color:#5af78e">&#39;标题&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$properties</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setDescription</span>(<span style="color:#5af78e">&#39;描述&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$properties</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setCategory</span>(<span style="color:#5af78e">&#39;技术整理&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$properties</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setLastModifiedBy</span>(<span style="color:#5af78e">&#39;最后修改人名称&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$properties</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setCreated</span>(mktime(<span style="color:#ff9f43">0</span>, <span style="color:#ff9f43">0</span>, <span style="color:#ff9f43">0</span>, <span style="color:#ff9f43">10</span>, <span style="color:#ff9f43">18</span>, <span style="color:#ff9f43">2023</span>));
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$properties</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setModified</span>(mktime(<span style="color:#ff9f43">0</span>, <span style="color:#ff9f43">0</span>, <span style="color:#ff9f43">0</span>, <span style="color:#ff9f43">10</span>, <span style="color:#ff9f43">18</span>, <span style="color:#ff9f43">2023</span>));
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$properties</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setSubject</span>(<span style="color:#5af78e">&#39;主题&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$properties</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setKeywords</span>(<span style="color:#5af78e">&#39;关键字&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 3) 基本单位
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// Open Office XML 中的基本长度单位是缇【twip】。缇的意思是“二十分之一英寸”，即 1 缇 = 1/1440 英寸。
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// 您可以使用 PHPWord 辅助函数将英寸、厘米或点转换为缇。
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// Paragraph with 6 points space after
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addParagraphStyle</span>(<span style="color:#5af78e">&#39;My Style&#39;</span>, <span style="color:#ff6ac1">array</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;spaceAfter&#39;</span> <span style="color:#ff6ac1">=&gt;</span> \PhpOffice\PhpWord\Shared\Converter<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">pointToTwip</span>(<span style="color:#ff9f43">6</span>))
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 第一节 BGN
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addSection</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$sectionStyle</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getStyle</span>();
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 调整左边距【英寸 =&gt; TWIP(TWIP 是一个微小的长度单位，通常用于印刷和排版领域，等于一英寸的 1/20，即每英寸包含 20 个 TWIP)】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$sectionStyle</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setMarginLeft</span>(\PhpOffice\PhpWord\Shared\Converter<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">inchToTwip</span>(<span style="color:#ff6ac1">.</span><span style="color:#ff9f43">5</span>));
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 调整右边距【厘米 =&gt; TWIP】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$sectionStyle</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setMarginRight</span>(\PhpOffice\PhpWord\Shared\Converter<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">cmToTwip</span>(<span style="color:#ff9f43">2</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addHeader</span>(\PhpOffice\PhpWord\Element\Header<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">AUTO</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;第一页眉&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;拼写和语法校验：I can\&#39;t spaek english!&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;语法错误标记和提示，goed =&gt; go 才是正确的：I goed to the store.&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;今年GDP增速目标为0.05&#39;</span>,[<span style="color:#5af78e">&#39;color&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;#0033CC&#39;</span>,<span style="color:#5af78e">&#39;size&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">15</span>,<span style="color:#5af78e">&#39;bold&#39;</span><span style="color:#ff6ac1">=&gt;</span><span style="color:#ff6ac1">true</span>,<span style="color:#5af78e">&#39;italic&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>]);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 第一节 END
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$objWriter</span> <span style="color:#ff6ac1">=</span> IOFactory<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">createWriter</span>(<span style="color:#ff5c57">$phpWord</span>,<span style="color:#5af78e">&#39;Word2007&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$objWriter</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">save</span>(<span style="color:#ff5c57">$output</span>);
</span></span></code></pre></div><p>Wps 效果图：</p>
<p><img src="/phpword/img/phpword_settings_wps.png"
	width="1460"
	height="485"
	srcset="/phpword/img/phpword_settings_wps_hu620dd89df5ff39b1c604f3a9a5714177_42411_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/phpword_settings_wps_hu620dd89df5ff39b1c604f3a9a5714177_42411_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="PHPWord Settings Wps"
	
	
		class="gallery-image" 
		data-flex-grow="301"
		data-flex-basis="722px"
	
></p>
<p><img src="/phpword/img/phpword_settings_info_wps.png"
	width="466"
	height="610"
	srcset="/phpword/img/phpword_settings_info_wps_hucea8614bfeedd5acd0f07dbbe1a1c572_30073_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/phpword_settings_info_wps_hucea8614bfeedd5acd0f07dbbe1a1c572_30073_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="Document Info Wps"
	
	
		class="gallery-image" 
		data-flex-grow="76"
		data-flex-basis="183px"
	
></p>
<p>Word2016 效果图：</p>
<p><img src="/phpword/img/phpword_settings_word.png"
	width="1294"
	height="328"
	srcset="/phpword/img/phpword_settings_word_hu4776f7d4e836b143248f780bbf783d93_30043_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/phpword_settings_word_hu4776f7d4e836b143248f780bbf783d93_30043_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="PHPWord Settings Word"
	
	
		class="gallery-image" 
		data-flex-grow="394"
		data-flex-basis="946px"
	
></p>
<p><img src="/phpword/img/phpword_settings_info_word.png"
	width="380"
	height="676"
	srcset="/phpword/img/phpword_settings_info_word_huf6c7e2e91737284e55472b312b50a6a9_22872_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/phpword_settings_info_word_huf6c7e2e91737284e55472b312b50a6a9_22872_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="Document Info Word"
	
	
		class="gallery-image" 
		data-flex-grow="56"
		data-flex-basis="134px"
	
></p>
<blockquote>
<p>Word2016 检测不出语法错误 是因为 设置语言默认为中文</p>
</blockquote>
<h3 id="converter-单位转换类">Converter 单位转换类</h3>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>函数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>cmToTwip</td>
<td>将 厘米 转换为 TWIP 单位</td>
</tr>
<tr>
<td>cmToInch</td>
<td>将 厘米 转换为 英寸</td>
</tr>
<tr>
<td>cmToPixel</td>
<td>将 厘米 转换为 像素</td>
</tr>
<tr>
<td>cmToPoint</td>
<td>将 厘米 转换为 磅【1 厘米 约等于 28.3465 磅】</td>
</tr>
<tr>
<td>cmToEmu</td>
<td>将 厘米 转换为 EMU（English Metric Unit），EMU 通常 用于处理 Office 中的 图像 和 形状</td>
</tr>
<tr>
<td>inchToTwip</td>
<td>将 英寸 转换为 TwipinchToCm将 英寸 转换为 厘米</td>
</tr>
<tr>
<td>inchToPixel</td>
<td>将 英寸 转换为 像素inchToPoint将 英寸 转换为 磅</td>
</tr>
<tr>
<td>inchToEmu</td>
<td>将 英寸 转换为 EMU</td>
</tr>
<tr>
<td>pixelToTwip</td>
<td>将 像素 转换为 Twip</td>
</tr>
<tr>
<td>pixelToCm</td>
<td>将 像素 转换为 厘米</td>
</tr>
<tr>
<td>pixelToPoint</td>
<td>将 像素 转换为 磅</td>
</tr>
<tr>
<td>pixelToEmu</td>
<td>将 像素 转换为 EMU</td>
</tr>
<tr>
<td>pointToTwip</td>
<td>将 磅 转换为 Twip</td>
</tr>
<tr>
<td>pointToPixel</td>
<td>将 磅 转换为 像素</td>
</tr>
<tr>
<td>pointToEmu</td>
<td>将 磅 转换为 EMU</td>
</tr>
<tr>
<td>pointToCm</td>
<td>将 磅 转换为 厘米</td>
</tr>
<tr>
<td>emuToPixel</td>
<td>将 EMU转换为 像素</td>
</tr>
</tbody>
</table></div>
<p><img src="/phpword/img/phpword_converter.png"
	width="1085"
	height="638"
	srcset="/phpword/img/phpword_converter_hu63815eecfbfc6b97df46d7dcc84c6199_117433_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/phpword_converter_hu63815eecfbfc6b97df46d7dcc84c6199_117433_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="PHPWord Converter"
	
	
		class="gallery-image" 
		data-flex-grow="170"
		data-flex-basis="408px"
	
></p>
<h2 id="容器">容器</h2>
<p>容器是可以放置元素（文本、列表、表格等）的对象。有 3 个主要容器，即节、页眉和页脚。其他容器有 文本、表格单元格和脚注等。</p>
<h3 id="section-片段节">Section 片段(节)</h3>
<h4 id="布局与样式配置">布局与样式配置</h4>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>参数</th>
<th>值</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>breakType</td>
<td>continuous：追加 <br> nextPage：下一页 <br> nextColumn：下一列 <br> evenPage：奇数页 <br> oddPage：偶数页</td>
<td>新增 节 与 之前节的 分隔 类型<br>【默认是 continuous】</td>
</tr>
<tr>
<td>paperSize</td>
<td>A3、A4、A5、B5等</td>
<td>设置页面尺寸</td>
</tr>
<tr>
<td>pageSizeW</td>
<td>210</td>
<td>设置页面宽度</td>
</tr>
<tr>
<td>pageSizeH</td>
<td>210</td>
<td>设置页面高度</td>
</tr>
<tr>
<td>orientation</td>
<td>横向（Landscape）、横向（Portrait）</td>
<td>指定页面的方向</td>
</tr>
<tr>
<td>marginTop</td>
<td>100</td>
<td>与上边框距离</td>
</tr>
<tr>
<td>marginLeft</td>
<td>20</td>
<td>与左边框距离</td>
</tr>
<tr>
<td>marginRight</td>
<td>20</td>
<td>与右边框距离</td>
</tr>
<tr>
<td>marginBottom</td>
<td>100</td>
<td>与下边框距离</td>
</tr>
<tr>
<td>gutter</td>
<td>0.5英寸</td>
<td>装订线的宽度</td>
</tr>
<tr>
<td>headerHeight</td>
<td>50英寸</td>
<td>设置页眉的高度</td>
</tr>
<tr>
<td>footerHeight</td>
<td>50英寸</td>
<td>设置页脚的高度</td>
</tr>
<tr>
<td>pageNumberingStart</td>
<td>1</td>
<td>设置文档第一页为起始页</td>
</tr>
<tr>
<td>colsNum</td>
<td>2</td>
<td>分隔列数</td>
</tr>
<tr>
<td>colsSpace</td>
<td>720 TWIPS</td>
<td>每列之间的间隔</td>
</tr>
<tr>
<td>lineNumbering</td>
<td>array()</td>
<td>添加行号</td>
</tr>
<tr>
<td>valign</td>
<td>top、center、both、bottom</td>
<td>指定文本位置</td>
</tr>
</tbody>
</table></div>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#78787e">// 添加片段
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addSection</span>([
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;colsNum&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">2</span>,     <span style="color:#78787e">// 列数
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;lineNumbering&#39;</span> <span style="color:#ff6ac1">=&gt;</span> [], <span style="color:#78787e">// 行号
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;colsSpace&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">800</span>, <span style="color:#78787e">// 列间距
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 添加 页眉、页脚
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addHeader</span>()<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;页眉&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addFooter</span>()<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;页脚&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// nextColumn 示例
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addSection</span>([<span style="color:#5af78e">&#39;colsNum&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">2</span> , <span style="color:#5af78e">&#39;breakType&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;nextColumn&#39;</span>]);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;第一列内容&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addSection</span>([<span style="color:#5af78e">&#39;colsNum&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">2</span>, <span style="color:#5af78e">&#39;breakType&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;nextColumn&#39;</span>]);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;第二列内容&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 新增一页
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addPageBreak</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addSection</span>([<span style="color:#5af78e">&#39;breakType&#39;</span><span style="color:#ff6ac1">=&gt;</span><span style="color:#5af78e">&#39;nextPage&#39;</span>]);
</span></span></code></pre></div><p><img src="/phpword/img/phpword_section_1.png"
	width="730"
	height="541"
	srcset="/phpword/img/phpword_section_1_hucbcbe1a44b295b18b4b927a631828d48_11412_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/phpword_section_1_hucbcbe1a44b295b18b4b927a631828d48_11412_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="PHPWord Section 1"
	
	
		class="gallery-image" 
		data-flex-grow="134"
		data-flex-basis="323px"
	
></p>
<p><img src="/phpword/img/phpword_section_1.png"
	width="730"
	height="541"
	srcset="/phpword/img/phpword_section_1_hucbcbe1a44b295b18b4b927a631828d48_11412_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/phpword_section_1_hucbcbe1a44b295b18b4b927a631828d48_11412_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="PHPWord Section 2"
	
	
		class="gallery-image" 
		data-flex-grow="134"
		data-flex-basis="323px"
	
></p>
<h3 id="多选框">多选框</h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#78787e">// section 中添加 多选框
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCheckBox</span>(<span style="color:#5af78e">&#39;checkbox_section&#39;</span>, <span style="color:#5af78e">&#39;请选择&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 表格中添加 多选框
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$table</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTable</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addRow</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$cell</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$cell</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCheckBox</span>(<span style="color:#5af78e">&#39;checkbox_cell&#39;</span>, <span style="color:#5af78e">&#39;请选择&#39;</span>);
</span></span></code></pre></div><p><img src="/phpword/img/phpword_checkbox.png"
	width="468"
	height="261"
	srcset="/phpword/img/phpword_checkbox_hu214ca04a4762bd14103b606e369f91ab_13279_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/phpword_checkbox_hu214ca04a4762bd14103b606e369f91ab_13279_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="PHPWord Checkbox"
	
	
		class="gallery-image" 
		data-flex-grow="179"
		data-flex-basis="430px"
	
></p>
<blockquote>
<p>交互多选框 需要确保 文档保护级别 为 允许与表单字段交互</p>
</blockquote>
<h3 id="添加注释">添加注释</h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff5c57">$filePath</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$this</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">file_path</span><span style="color:#ff6ac1">.</span><span style="color:#5af78e">&#39;comment.docx&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$imgPath</span> <span style="color:#ff6ac1">=</span>  <span style="color:#ff5c57">$this</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">img_path</span><span style="color:#ff6ac1">.</span><span style="color:#5af78e">&#39;cat.png&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$phpWord</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">new</span> PhpWord();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 指定语言
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getSettings</span>()<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setThemeFontLang</span>(<span style="color:#ff6ac1">new</span> Language(Language<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">ZH_CN</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 新增节
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addSection</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 指定注释起始位置
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$comment</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">new</span> Comment(<span style="color:#5af78e">&#39;申通通&#39;</span>,<span style="color:#ff6ac1">new</span> \DateTime(),<span style="color:#5af78e">&#39;stt&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$comment</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;本文由申通通撰写&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addComment</span>(<span style="color:#ff5c57">$comment</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$textRun</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextRun</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$textRun</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;关于本文的&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$textRun</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;作者&#39;</span>,[<span style="color:#5af78e">&#39;bold&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>,<span style="color:#5af78e">&#39;italic&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setCommentRangeStart</span>(<span style="color:#ff5c57">$comment</span>); <span style="color:#78787e">// 默认注释范围包括本段文本全部内容
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$textRun</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;是谁这件事&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>(<span style="color:#ff9f43">2</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 指定注释 起始 与 结束 位置
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$commentWithStartAndEnd</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">new</span> Comment(<span style="color:#5af78e">&#39;申通通&#39;</span>,<span style="color:#ff6ac1">new</span> \DateTime(<span style="color:#5af78e">&#39;now&#39;</span>,<span style="color:#ff6ac1">new</span> \DateTimeZone(<span style="color:#5af78e">&#39;Asia/Shanghai&#39;</span>)),<span style="color:#5af78e">&#39;stt&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$commentWithStartAndEnd</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;唐宋八大家之一？&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addComment</span>(<span style="color:#ff5c57">$commentWithStartAndEnd</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$textRunWithEnd</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextRun</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$textRunWithEnd</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;琵琶行 的作者是 &#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$textRunWithEnd</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;白居易：&#39;</span>, [<span style="color:#5af78e">&#39;bold&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setCommentRangeStart</span>(<span style="color:#ff5c57">$commentWithStartAndEnd</span>); <span style="color:#78787e">// 注释起始位置
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$textRunWithEnd</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39; 千呼万唤始出来， &#39;</span>, [<span style="color:#5af78e">&#39;italic&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>]);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$textRunWithEnd</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39; 犹抱琵琶半遮面 &#39;</span>,[<span style="color:#5af78e">&#39;italic&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setCommentRangeEnd</span>(<span style="color:#ff5c57">$commentWithStartAndEnd</span>); <span style="color:#78787e">// 注释结束位置
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>(<span style="color:#ff9f43">2</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 给图片添加 起始 注释
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$imgComment</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">new</span> Comment(<span style="color:#5af78e">&#39;My cat&#39;</span>,<span style="color:#ff6ac1">new</span> \DateTime());
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$imgComment</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextRun</span>()<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;猫科动物是一目了然的东西&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addComment</span>(<span style="color:#ff5c57">$imgComment</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addImage</span>(<span style="color:#ff5c57">$imgPath</span>, [<span style="color:#5af78e">&#39;width&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">100</span>, <span style="color:#5af78e">&#39;height&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">100</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setCommentRangeStart</span>(<span style="color:#ff5c57">$imgComment</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>(<span style="color:#ff9f43">2</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 除了上边添加注释的方式，还可以将 注释 指向 文本对象
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$text</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;通过注释指向文本对象的方式来添加注释&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$comment</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">new</span> Comment(<span style="color:#5af78e">&#39;stt&#39;</span>,<span style="color:#ff6ac1">new</span> \DateTime(),<span style="color:#5af78e">&#39;my_initials&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$comment</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;测试注释&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$comment</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setStartElement</span>(<span style="color:#ff5c57">$text</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$comment</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setEndElement</span>(<span style="color:#ff5c57">$text</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addComment</span>(<span style="color:#ff5c57">$comment</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>IOFactory<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">createWriter</span>(<span style="color:#ff5c57">$phpWord</span>,<span style="color:#5af78e">&#39;Word2007&#39;</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">save</span>(<span style="color:#ff5c57">$filePath</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">echo</span> <span style="color:#5af78e">&#39;success&#39;</span>;
</span></span></code></pre></div><p><img src="/phpword/img/phpword_comment.png"
	width="1219"
	height="455"
	srcset="/phpword/img/phpword_comment_hua23e30c3787d9f3121c03b827d5bc946_87483_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/phpword_comment_hua23e30c3787d9f3121c03b827d5bc946_87483_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="PHPWord Comment"
	
	
		class="gallery-image" 
		data-flex-grow="267"
		data-flex-basis="642px"
	
></p>
<h3 id="添加字段">添加字段</h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#78787e">// 在 头部添加 当前页数 与 总页数
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addHeader</span>()<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addPreserveText</span>(<span style="color:#5af78e">&#39;page {PAGE} of {NUMPAGES}&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 添加 日期字段
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addField</span>(<span style="color:#5af78e">&#39;DATE&#39;</span>,[<span style="color:#5af78e">&#39;dateformat&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;d-M-yy HH:mm&#39;</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setFontStyle</span>(<span style="color:#ff5c57">$customFontName</span>); <span style="color:#78787e">// 指定 日期显示格式
</span></span></span></code></pre></div><blockquote>
<p>section 中添加 总页数 与 当前页数 无法生效：https://phpword-zh.readthedocs.io/zh-cn/latest/elements.html#fields</p>
</blockquote>
<h3 id="添加-脚注-和-尾注">添加 脚注 和 尾注</h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff5c57">$phpWord</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">new</span> PhpWord();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addSection</span>([<span style="color:#5af78e">&#39;pageSizeW&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Converter<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">pixelToTwip</span>(<span style="color:#ff9f43">400</span>),<span style="color:#5af78e">&#39;pageSizeH&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Converter<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">pixelToTwip</span>(<span style="color:#ff9f43">500</span>)]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 给文本添加 脚注 BGN
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$textRun</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextRun</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$textRun</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;PHP&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$footNote</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$textRun</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addFootnote</span>();
</span></span><span style="display:flex;"><span><span style="color:#78787e">// $footNote-&gt;addText(&#39;Hypertext Preprocessor&#39;); // 脚注 可以是 纯文本
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// $footNote-&gt;addLink(&#39;https://www.php.net&#39;,&#39;Hypertext Preprocessor&#39;); // 脚注 可以是 链接
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// $footNote-&gt;addImage($this-&gt;img_path.&#39;cat.png&#39;,[&#39;width&#39;=&gt;100,&#39;height&#39;=&gt;100]); // 脚注 可以是 图片
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$footNote</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addObject</span>(<span style="color:#ff5c57">$this</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">file_path</span><span style="color:#ff6ac1">.</span><span style="color:#5af78e">&#39;_attribute.xls&#39;</span>,[<span style="color:#5af78e">&#39;width&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">18</span>, <span style="color:#5af78e">&#39;height&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">18</span>]); <span style="color:#78787e">// 脚注 可以是 文件对象【支持 &#39;xls&#39;, &#39;doc&#39;, &#39;ppt&#39;, &#39;xlsx&#39;, &#39;docx&#39;, &#39;pptx&#39; 格式】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$textRun</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;是世界上最好的语言!&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 给文本添加 脚注 END
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 直接添加脚注元素 BGN
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;一个独立的段落文本内容...&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$footNote</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addFootnote</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$footNote</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;段落文本的footNote!&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 直接添加脚注元素 END
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>(<span style="color:#ff9f43">7</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 添加 尾注【文章最末尾】 BGN
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$textRun</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextRun</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$endNote</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$textRun</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addEndnote</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$endNote</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;其他语言:Java、Python、Golang、Rust&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 添加 尾注 END
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span>IOFactory<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">createWriter</span>(<span style="color:#ff5c57">$phpWord</span>,<span style="color:#5af78e">&#39;Word2007&#39;</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">save</span>(<span style="color:#ff5c57">$this</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">file_path</span><span style="color:#ff6ac1">.</span><span style="color:#5af78e">&#39;note.docx&#39;</span>);
</span></span></code></pre></div><p><img src="/phpword/img/phpword_footnote_endnote.png"
	width="996"
	height="523"
	srcset="/phpword/img/phpword_footnote_endnote_hu56d4a1e646b83f9f18510a6b74d97778_21785_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/phpword_footnote_endnote_hu56d4a1e646b83f9f18510a6b74d97778_21785_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="PHPWord FootNote EndNote"
	
	
		class="gallery-image" 
		data-flex-grow="190"
		data-flex-basis="457px"
	
></p>
<blockquote>
<p>1）可以通过 FootnoteProperties 类 来设置 脚注位置、起始编号、脚注编号格式等</p>
<p>2）通过 word2016 打开文档中的 附件脚注 会 导致脚注大小发生变化，wps没有这个问题【不兼容】</p>
</blockquote>
<h3 id="添加图像-与-横线">添加图像 与 横线</h3>
<p>可以 给 节、页眉、页脚、textRun、表格单元格等 添加图像</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff5c57">$localImg</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$this</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">img_path</span><span style="color:#ff6ac1">.</span><span style="color:#5af78e">&#39;cat.png&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$ossImg</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#39;https://ent.buildhr.com/img/login-bg.png&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$phpWord</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">new</span> PhpWord();
</span></span><span style="display:flex;"><span><span style="color:#78787e">// $section = $phpWord-&gt;addSection([&#39;pageSizeW&#39; =&gt; Converter::pixelToTwip(400), &#39;pageSizeH&#39; =&gt; Converter::pixelToTwip(500)]);
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addSection</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$imgStyle</span> <span style="color:#ff6ac1">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;width&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Converter<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">pixelToPoint</span>(<span style="color:#ff9f43">60</span>), <span style="color:#78787e">// 图片的宽度【pt =&gt; 磅】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;height&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Converter<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">pixelToPoint</span>(<span style="color:#ff9f43">60</span>), <span style="color:#78787e">// 图片高度【pt =&gt; 磅】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;marginTop&#39;</span>     <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">0</span>, <span style="color:#78787e">// 相对于 顶部边界 的 偏移量，可以是 负值【inches =&gt; 英寸】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;marginLeft&#39;</span>    <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">0</span>, <span style="color:#78787e">// 相对于 左边边界 的 偏移量，可以是 负值【inches =&gt; 英寸】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;alignment&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Jc<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">CENTER</span>, <span style="color:#78787e">// 图片位置
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#78787e">// 设置换行样式
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#78787e">// Style\Frame::WRAP_INLINE =&gt; 内嵌方式、图片 与 文本 在 同一行
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#78787e">// Style\Frame::WRAP_SQUARE =&gt; 图片周围环绕一个正方形区域，图片将在该区域内排布
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#78787e">// Style\Frame::WRAP_TIGHT  =&gt; 图片 与 文本 紧密排布，图片的形状会根据文本的布局调整
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#78787e">// Style\Frame::WRAP_BEHIND =&gt; 图片出现在文本后方，图片会被遮挡
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#78787e">// Style\Frame::WRAP_INFRONT =&gt; 图片出现在文本前方,文本会被遮挡
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;wrappingStyle&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Style\Frame<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">WRAP_SQUARE</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;wrapDistanceRight&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">50</span>, <span style="color:#78787e">// 指定图片右侧的空白距离【像素】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;wrapDistanceBottom&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">50</span>, <span style="color:#78787e">// 指定图片底部的空白距离【像素】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>];
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 1) 给 节 添加本地图像
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>(<span style="color:#ff9f43">5</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addImage</span>(<span style="color:#ff5c57">$localImg</span>,<span style="color:#ff5c57">$imgStyle</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>(<span style="color:#ff9f43">5</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 2) 给 文本 添加远程图像
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$textRun</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextRun</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$textRun</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;天街小雨润如酥，草色遥看近却无&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$textRun</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addImage</span>(<span style="color:#ff5c57">$ossImg</span>,<span style="color:#ff5c57">$imgStyle</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$textRun</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;最是一年春好处，绝胜烟柳满皇都&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>();
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 3) 给 页眉、页脚 添加图像
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addHeader</span>()<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addImage</span>(<span style="color:#ff5c57">$localImg</span>,<span style="color:#ff5c57">$imgStyle</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addFooter</span>()<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addImage</span>(<span style="color:#ff5c57">$localImg</span>,<span style="color:#ff5c57">$imgStyle</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>(<span style="color:#ff9f43">5</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 4) 添加 横线
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// weight : 宽度 【twip】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// dash : 线条类型【dash =&gt; 虚线、rounddot =&gt;圆点线、squaredot =&gt; 方点线、dashdot =&gt; 点划线、longdash =&gt; 长划线
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// longdashdot =&gt; 长点划线、longdashdotdot =&gt; 长 点点 划线】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// beginArrow : 起始箭头类型【block =&gt; 方块箭头、open =&gt; 打开的箭头、classic =&gt; 经典箭头、diamond =&gt; 菱形箭头、oval =&gt; 椭圆箭头】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// endArrow : 结束箭头类型 与 起始箭头类型 一致
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// width : 线条对象的宽度【磅 =&gt; point】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// height : 线条对象的高度【磅 =&gt; point】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// flip : 翻转线条元素的方向，true 或 false
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$lineStyle</span> <span style="color:#ff6ac1">=</span> [<span style="color:#5af78e">&#39;weight&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">1</span>, <span style="color:#5af78e">&#39;width&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">400</span>, <span style="color:#5af78e">&#39;height&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">5</span>, <span style="color:#5af78e">&#39;color&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;red&#39;</span>,<span style="color:#5af78e">&#39;dash&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;dashdot&#39;</span>];
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addLine</span>(<span style="color:#ff5c57">$lineStyle</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>IOFactory<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">createWriter</span>(<span style="color:#ff5c57">$phpWord</span>,<span style="color:#5af78e">&#39;Word2007&#39;</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">save</span>(<span style="color:#ff5c57">$this</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">file_path</span><span style="color:#ff6ac1">.</span><span style="color:#5af78e">&#39;image.docx&#39;</span>);
</span></span></code></pre></div><p><img src="/phpword/img/phpword_image_line.png"
	width="993"
	height="646"
	srcset="/phpword/img/phpword_image_line_hu995c8133ea22c08fd7945a3089160188_73274_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/phpword_image_line_hu995c8133ea22c08fd7945a3089160188_73274_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="PHPWord Image Line"
	
	
		class="gallery-image" 
		data-flex-grow="153"
		data-flex-basis="368px"
	
></p>
<h3 id="基本元素">基本元素</h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#78787e">// 插入链接 BGN
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addLink</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;https://www.google.com&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;谷歌一下&#39;</span>,
</span></span><span style="display:flex;"><span>    [
</span></span><span style="display:flex;"><span>        <span style="color:#78787e">// &#39;color&#39; =&gt; &#39;red&#39;,
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>        <span style="color:#5af78e">&#39;bold&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#39;underline&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Font<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">UNDERLINE_DASH</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#39;size&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">18</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#39;fgColor&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;red&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#78787e">// &#39;superScript&#39; =&gt; true, // 上标文本效果
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>        <span style="color:#78787e">// &#39;strikeThrough&#39; =&gt; true, // 删除线
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>        <span style="color:#78787e">// &#39;bgColor&#39; =&gt; &#39;black&#39;, // 背景颜色
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>        <span style="color:#78787e">// &#39;strikeThrough&#39; =&gt; true,
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    ],
</span></span><span style="display:flex;"><span>    [
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#39;align&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;left&#39;</span>, <span style="color:#78787e">// 对齐方式
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>        <span style="color:#5af78e">&#39;identation&#39;</span> <span style="color:#ff6ac1">=&gt;</span> [<span style="color:#5af78e">&#39;left&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">2</span>,<span style="color:#5af78e">&#39;right&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">2</span>], <span style="color:#78787e">// 缩进设置，包括 左缩进、右缩进【英寸】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>        <span style="color:#5af78e">&#39;spacing&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">1.5</span>, <span style="color:#78787e">// 行间距【1.5 =&gt; 1.5倍行间距】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>        <span style="color:#5af78e">&#39;firstLineIdent&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">0.5</span>, <span style="color:#78787e">// 首行缩进【英寸】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>        <span style="color:#5af78e">&#39;background&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;black&#39;</span>, <span style="color:#78787e">// 背景色
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    ]
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 插入链接 END
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 插入列表 BGN
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 1) 添加 普通列表
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;编程语言列表:&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItem</span>(<span style="color:#5af78e">&#39;PHP&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItem</span>(<span style="color:#5af78e">&#39;Java&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItem</span>(<span style="color:#5af78e">&#39;Golang&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItem</span>(<span style="color:#5af78e">&#39;Python&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItem</span>(<span style="color:#5af78e">&#39;Ruby&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItem</span>(<span style="color:#5af78e">&#39;Rust&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 2) 添加 分级列表
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$multiLevelNumberingStyleName</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#39;multilevel&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addNumberingStyle</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">$multiLevelNumberingStyleName</span>,
</span></span><span style="display:flex;"><span>    [
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#39;type&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;multilevel&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#39;levels&#39;</span> <span style="color:#ff6ac1">=&gt;</span> [
</span></span><span style="display:flex;"><span>            [<span style="color:#5af78e">&#39;format&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;decimal&#39;</span>,<span style="color:#5af78e">&#39;text&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;%1&#39;</span>,<span style="color:#5af78e">&#39;left&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">350</span>],
</span></span><span style="display:flex;"><span>            [<span style="color:#5af78e">&#39;format&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;decimal&#39;</span>,<span style="color:#5af78e">&#39;text&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;%1.%2&#39;</span>,<span style="color:#5af78e">&#39;left&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">700</span>],
</span></span><span style="display:flex;"><span>            [<span style="color:#5af78e">&#39;format&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;decimal&#39;</span>,<span style="color:#5af78e">&#39;text&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;%1.%2.%3&#39;</span>,<span style="color:#5af78e">&#39;left&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">1050</span>],
</span></span><span style="display:flex;"><span>        ]
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;水果&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItem</span>(<span style="color:#5af78e">&#39;苹果&#39;</span>,<span style="color:#ff9f43">0</span>,<span style="color:#ff6ac1">null</span>,<span style="color:#ff5c57">$multiLevelNumberingStyleName</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItem</span>(<span style="color:#5af78e">&#39;红富士&#39;</span>,<span style="color:#ff9f43">1</span>,<span style="color:#ff6ac1">null</span>,<span style="color:#ff5c57">$multiLevelNumberingStyleName</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItem</span>(<span style="color:#5af78e">&#39;百花果&#39;</span>,<span style="color:#ff9f43">2</span>,<span style="color:#ff6ac1">null</span>,<span style="color:#ff5c57">$multiLevelNumberingStyleName</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItem</span>(<span style="color:#5af78e">&#39;香蕉&#39;</span>,<span style="color:#ff9f43">0</span>,<span style="color:#ff6ac1">null</span>,<span style="color:#ff5c57">$multiLevelNumberingStyleName</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItem</span>(<span style="color:#5af78e">&#39;芭蕉&#39;</span>,<span style="color:#ff9f43">1</span>,<span style="color:#ff6ac1">null</span>,<span style="color:#ff5c57">$multiLevelNumberingStyleName</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>(<span style="color:#ff9f43">2</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 带样式的列表
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// 自定义 列表符号
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// TYPE_SQUARE_FILLED =&gt; 实心方块
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// TYPE_BULLET_FILLED =&gt; 实心圆点
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// TYPE_BULLET_EMPTY  =&gt; 空心圆点
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// TYPE_NUMBER =&gt; 数字
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// TYPE_NUMBER_NESTED =&gt; 嵌套数字
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// TYPE_ALPHANUM =&gt; 字母、数字 组合
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$alphaNumMultiLevelStyle</span> <span style="color:#ff6ac1">=</span> [<span style="color:#5af78e">&#39;listType&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Style\ListItem<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">TYPE_ALPHANUM</span>];
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItem</span>(<span style="color:#5af78e">&#39;山西&#39;</span>,<span style="color:#ff9f43">0</span>,<span style="color:#ff6ac1">null</span>,<span style="color:#ff5c57">$alphaNumMultiLevelStyle</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItem</span>(<span style="color:#5af78e">&#39;太原&#39;</span>,<span style="color:#ff9f43">1</span>,<span style="color:#ff6ac1">null</span>,<span style="color:#ff5c57">$alphaNumMultiLevelStyle</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItem</span>(<span style="color:#5af78e">&#39;临汾&#39;</span>,<span style="color:#ff9f43">1</span>,<span style="color:#ff6ac1">null</span>,<span style="color:#ff5c57">$alphaNumMultiLevelStyle</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItem</span>(<span style="color:#5af78e">&#39;洪洞&#39;</span>,<span style="color:#ff9f43">2</span>,<span style="color:#ff6ac1">null</span>,<span style="color:#ff5c57">$alphaNumMultiLevelStyle</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItem</span>(<span style="color:#5af78e">&#39;河北&#39;</span>,<span style="color:#ff9f43">0</span>,<span style="color:#ff6ac1">null</span>,<span style="color:#ff5c57">$alphaNumMultiLevelStyle</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItem</span>(<span style="color:#5af78e">&#39;邯郸&#39;</span>,<span style="color:#ff9f43">1</span>,<span style="color:#ff6ac1">null</span>,<span style="color:#ff5c57">$alphaNumMultiLevelStyle</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItem</span>(<span style="color:#5af78e">&#39;大明&#39;</span>,<span style="color:#ff9f43">2</span>,<span style="color:#ff6ac1">null</span>,<span style="color:#ff5c57">$alphaNumMultiLevelStyle</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItem</span>(<span style="color:#5af78e">&#39;邢台&#39;</span>,<span style="color:#ff9f43">1</span>,<span style="color:#ff6ac1">null</span>,<span style="color:#ff5c57">$alphaNumMultiLevelStyle</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItem</span>(<span style="color:#5af78e">&#39;石家庄&#39;</span>,<span style="color:#ff9f43">1</span>,<span style="color:#ff6ac1">null</span>,<span style="color:#ff5c57">$alphaNumMultiLevelStyle</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>(<span style="color:#ff9f43">2</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 3) 给列表文本添加样式
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$numberNestedMultiLevelStyle</span><span style="color:#ff6ac1">=</span> [<span style="color:#5af78e">&#39;listType&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Style\ListItem<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">TYPE_NUMBER_NESTED</span>];
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTitle</span>(<span style="color:#5af78e">&#39;段落文本列表&#39;</span>,<span style="color:#ff9f43">1</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>(<span style="color:#ff9f43">2</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;一台主机包括:&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItemRun</span>(<span style="color:#ff9f43">0</span>,<span style="color:#ff5c57">$numberNestedMultiLevelStyle</span>,<span style="color:#ff5c57">$paragraphStyleName</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;主板&#39;</span>,[<span style="color:#5af78e">&#39;bold&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$listTextRun</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItemRun</span>(<span style="color:#ff9f43">0</span>,<span style="color:#ff5c57">$numberNestedMultiLevelStyle</span>,<span style="color:#ff5c57">$paragraphStyleName</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$listTextRun</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;CPU&#39;</span>,[<span style="color:#5af78e">&#39;italic&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>,<span style="color:#5af78e">&#39;bold&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$footNote</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$listTextRun</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addFootnote</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$footNote</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;著名 cpu品牌 有 英特尔 与 AMD&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$listTextRun</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;分为 盒装 与 片装，盒装有保修期，质量有保证!&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItemRun</span>(<span style="color:#ff9f43">1</span>,<span style="color:#ff5c57">$numberNestedMultiLevelStyle</span>,<span style="color:#ff5c57">$paragraphStyleName</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;i5系列&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItemRun</span>(<span style="color:#ff9f43">2</span>,<span style="color:#ff5c57">$numberNestedMultiLevelStyle</span>,<span style="color:#ff5c57">$paragraphStyleName</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;i5-13600KF&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItemRun</span>(<span style="color:#ff9f43">1</span>,<span style="color:#ff5c57">$numberNestedMultiLevelStyle</span>,<span style="color:#ff5c57">$paragraphStyleName</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;i7系列&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItemRun</span>(<span style="color:#ff9f43">2</span>,<span style="color:#ff5c57">$numberNestedMultiLevelStyle</span>,<span style="color:#ff5c57">$paragraphStyleName</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;i7-13700KF&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$listTextRun</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addListItemRun</span>(<span style="color:#ff9f43">0</span>,<span style="color:#ff5c57">$numberNestedMultiLevelStyle</span>,<span style="color:#ff5c57">$paragraphStyleName</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$listTextRun</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;散热&#39;</span>,[<span style="color:#5af78e">&#39;underline&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;dash&#39;</span>]);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 插入列表 END
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 插入附件 BGN
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTitle</span>(<span style="color:#5af78e">&#39;插入 OLE 对象 附件&#39;</span>,<span style="color:#ff9f43">1</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addObject</span>(<span style="color:#ff5c57">$this</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">file_path</span><span style="color:#ff6ac1">.</span><span style="color:#5af78e">&#39;_attribute.xls&#39;</span>,[<span style="color:#5af78e">&#39;width&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">100</span>, <span style="color:#5af78e">&#39;height&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">100</span>]);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 插入附件 END
</span></span></span></code></pre></div><p><img src="/phpword/img/phpword_elements_1.png"
	width="995"
	height="723"
	srcset="/phpword/img/phpword_elements_1_huebd4d13915fde553f8c35c0aca7800f8_28063_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/phpword_elements_1_huebd4d13915fde553f8c35c0aca7800f8_28063_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="PHPWord Elements"
	
	
		class="gallery-image" 
		data-flex-grow="137"
		data-flex-basis="330px"
	
></p>
<p><img src="/phpword/img/phpword_elements_2.png"
	width="995"
	height="603"
	srcset="/phpword/img/phpword_elements_2_hu4ee20fdc9659c35c22fb5150a5e8146e_29349_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/phpword_elements_2_hu4ee20fdc9659c35c22fb5150a5e8146e_29349_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="PHPWord Elements"
	
	
		class="gallery-image" 
		data-flex-grow="165"
		data-flex-basis="396px"
	
></p>
<h3 id="插入表格">插入表格</h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff5c57">$phpWord</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">new</span> PhpWord();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addSection</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Style<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">addTitleStyle</span>(<span style="color:#ff9f43">1</span>,[<span style="color:#5af78e">&#39;bold&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>,<span style="color:#5af78e">&#39;size&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">22</span>]);
</span></span><span style="display:flex;"><span>Style<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">addTitleStyle</span>(<span style="color:#ff9f43">2</span>,[<span style="color:#5af78e">&#39;bold&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>,<span style="color:#5af78e">&#39;size&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">20</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$cellHeight</span> <span style="color:#ff6ac1">=</span> Converter<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">pixelToTwip</span>(<span style="color:#ff9f43">200</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 1) 添加 基本表格 BGN
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTitle</span>(<span style="color:#5af78e">&#39;基本表格&#39;</span>,<span style="color:#ff9f43">1</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$row</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">5</span>; <span style="color:#78787e">// 5 行
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$col</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">5</span>; <span style="color:#78787e">// 5 列
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// 自定义 表格名称
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$customTableStyleName</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#39;sttTable&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 第一行 表格样式
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$firstRowStyle</span> <span style="color:#ff6ac1">=</span> [<span style="color:#5af78e">&#39;borderSize&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">6</span>,<span style="color:#5af78e">&#39;bgColor&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;66BBFF&#39;</span>];
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 表格样式
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$tableStyle</span> <span style="color:#ff6ac1">=</span> [<span style="color:#5af78e">&#39;borderColor&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;006699&#39;</span>, <span style="color:#5af78e">&#39;borderSize&#39;</span>  <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">6</span>, <span style="color:#5af78e">&#39;cellMargin&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">50</span>, <span style="color:#5af78e">&#39;cellSpacing&#39;</span>  <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">50</span>];
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 注册 表格样式
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTableStyle</span>(<span style="color:#ff5c57">$customTableStyleName</span>,<span style="color:#ff5c57">$tableStyle</span>,<span style="color:#ff5c57">$firstRowStyle</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 添加 表格样式
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$table</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTable</span>(<span style="color:#ff5c57">$customTableStyleName</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">for</span> (<span style="color:#ff5c57">$i</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>;<span style="color:#ff5c57">$i</span><span style="color:#ff6ac1">&lt;</span><span style="color:#ff5c57">$row</span>;<span style="color:#ff5c57">$i</span><span style="color:#ff6ac1">++</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addRow</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">for</span> (<span style="color:#ff5c57">$j</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>;<span style="color:#ff5c57">$j</span><span style="color:#ff6ac1">&lt;</span><span style="color:#ff5c57">$col</span>;<span style="color:#ff5c57">$j</span><span style="color:#ff6ac1">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff9f43">1750</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;第&#39;</span><span style="color:#ff6ac1">.</span>(<span style="color:#ff5c57">$i</span><span style="color:#ff6ac1">+</span><span style="color:#ff9f43">1</span>)<span style="color:#ff6ac1">.</span><span style="color:#5af78e">&#39;行&#39;</span><span style="color:#ff6ac1">.</span>(<span style="color:#ff5c57">$j</span><span style="color:#ff6ac1">+</span><span style="color:#ff9f43">1</span>)<span style="color:#ff6ac1">.</span><span style="color:#5af78e">&#39;列&#39;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>();
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 1) 添加 基本表格 END
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>(<span style="color:#ff9f43">2</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 2) 高级表格 BGN
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTitle</span>(<span style="color:#5af78e">&#39;高级表格&#39;</span>,<span style="color:#ff9f43">1</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$fancyTableName</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#39;fancyTable&#39;</span>; <span style="color:#78787e">// 高级表格 名称
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$fancyTableStyle</span> <span style="color:#ff6ac1">=</span> [<span style="color:#5af78e">&#39;borderSize&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">6</span>, <span style="color:#5af78e">&#39;borderColor&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;006699&#39;</span>, <span style="color:#5af78e">&#39;cellMargin&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">80</span>, <span style="color:#5af78e">&#39;alignment&#39;</span> <span style="color:#ff6ac1">=&gt;</span> JcTable<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">CENTER</span>,<span style="color:#5af78e">&#39;cellSpacing&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">50</span>];
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$fancyTableFirstRowStyle</span> <span style="color:#ff6ac1">=</span> [<span style="color:#5af78e">&#39;borderBottomSize&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">18</span>, <span style="color:#5af78e">&#39;borderBottomColor&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;0000FF&#39;</span>,<span style="color:#5af78e">&#39;bgColor&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;66BBFF&#39;</span>];
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$fancyTableCellStyle</span> <span style="color:#ff6ac1">=</span> [<span style="color:#5af78e">&#39;valign&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;center&#39;</span>];
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$fancyTableCellBtlrStyle</span> <span style="color:#ff6ac1">=</span> [<span style="color:#5af78e">&#39;valign&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;center&#39;</span>,<span style="color:#5af78e">&#39;textDirection&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Style\Cell<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">TEXT_DIR_BTLR</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$fancyTableFontStyle</span> <span style="color:#ff6ac1">=</span> [<span style="color:#5af78e">&#39;bold&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>];
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTableStyle</span>(<span style="color:#ff5c57">$fancyTableName</span>,<span style="color:#ff5c57">$fancyTableStyle</span>,<span style="color:#ff5c57">$fancyTableFirstRowStyle</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTable</span>(<span style="color:#ff5c57">$fancyTableName</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addRow</span>(Converter<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">pixelToTwip</span>(<span style="color:#ff9f43">50</span>)); <span style="color:#78787e">// 行高 以 twip 为单位
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>, <span style="color:#ff5c57">$fancyTableCellStyle</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;第一行&#39;</span>, <span style="color:#ff5c57">$fancyTableFontStyle</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>, <span style="color:#ff5c57">$fancyTableCellStyle</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;第二行&#39;</span>, <span style="color:#ff5c57">$fancyTableFontStyle</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>, <span style="color:#ff5c57">$fancyTableCellStyle</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;第三行&#39;</span>, <span style="color:#ff5c57">$fancyTableFontStyle</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>, <span style="color:#ff5c57">$fancyTableCellStyle</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;第四行&#39;</span>, <span style="color:#ff5c57">$fancyTableFontStyle</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>, <span style="color:#ff5c57">$fancyTableCellBtlrStyle</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;第五行&#39;</span>, <span style="color:#ff5c57">$fancyTableFontStyle</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">for</span> (<span style="color:#ff5c57">$i</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>;<span style="color:#ff5c57">$i</span><span style="color:#ff6ac1">&lt;=</span><span style="color:#ff9f43">8</span>;<span style="color:#ff6ac1">++</span><span style="color:#ff5c57">$i</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addRow</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#34;Cell&#34;</span><span style="color:#ff6ac1">.</span>(<span style="color:#ff5c57">$i</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#34;Cell&#34;</span><span style="color:#ff6ac1">.</span>(<span style="color:#ff5c57">$i</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#34;Cell&#34;</span><span style="color:#ff6ac1">.</span>(<span style="color:#ff5c57">$i</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#34;Cell&#34;</span><span style="color:#ff6ac1">.</span>(<span style="color:#ff5c57">$i</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">$text</span> <span style="color:#ff6ac1">=</span> (<span style="color:#ff9f43">0</span> <span style="color:#ff6ac1">==</span> <span style="color:#ff5c57">$i</span> <span style="color:#ff6ac1">%</span> <span style="color:#ff9f43">2</span>) <span style="color:#ff6ac1">?</span> <span style="color:#5af78e">&#39;X&#39;</span> <span style="color:#ff6ac1">:</span> <span style="color:#5af78e">&#39;&#39;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#ff5c57">$text</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 2) 高级表格 END
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>(<span style="color:#ff9f43">2</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 3) 跨 行 与 列 BGN
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#5af78e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"> * 表格 合并 样式【行高、列宽】
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"> * 水平合并：[&#39;gridSpan&#39; =&gt; 2列, &#39;valign&#39; =&gt; &#39;center&#39;] =&gt; 合并 两列单元格 并 将 表格中的文本居中，需要注意将 单元格 的宽度设置合理
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"> * 竖直合并：[&#39;vMerge&#39; =&gt; &#39;restart&#39;, &#39;valign&#39; =&gt; &#39;center&#39;] =&gt; 合并 多列表格，添加下一行的时候指定 [&#39;vMerge&#39; =&gt; &#39;continue&#39;] 就继续合并
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTitle</span>(<span style="color:#5af78e">&#39;跨 行 与 列 表格&#39;</span>,<span style="color:#ff9f43">1</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$fancyTableStyle</span> <span style="color:#ff6ac1">=</span> [<span style="color:#5af78e">&#39;borderSize&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">6</span>, <span style="color:#5af78e">&#39;borderColor&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;999999&#39;</span>];
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$cellRowSpan</span> <span style="color:#ff6ac1">=</span> [<span style="color:#5af78e">&#39;vMerge&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;restart&#39;</span>, <span style="color:#5af78e">&#39;valign&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;center&#39;</span>, <span style="color:#5af78e">&#39;bgColor&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;FFFF00&#39;</span>];
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$cellRowContinue</span> <span style="color:#ff6ac1">=</span> [<span style="color:#5af78e">&#39;vMerge&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;continue&#39;</span>];
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$cellColSpan</span> <span style="color:#ff6ac1">=</span> [<span style="color:#5af78e">&#39;gridSpan&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">2</span>, <span style="color:#5af78e">&#39;valign&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;center&#39;</span>];
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$cellHCentered</span> <span style="color:#ff6ac1">=</span> [<span style="color:#5af78e">&#39;alignment&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Jc<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">CENTER</span>];
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$cellVCentered</span> <span style="color:#ff6ac1">=</span> [<span style="color:#5af78e">&#39;valign&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;center&#39;</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 注册表格样式名称
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$spanTableStyleName</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#39;ColSpanRowSpan&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTableStyle</span>(<span style="color:#ff5c57">$spanTableStyleName</span>,<span style="color:#ff5c57">$fancyTableStyle</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTable</span>(<span style="color:#ff5c57">$spanTableStyleName</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 第一行
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addRow</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$textRun1</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>,<span style="color:#ff5c57">$cellRowSpan</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextRun</span>(<span style="color:#ff5c57">$cellHCentered</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$textRun1</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;A&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$textRun1</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addFootnote</span>()<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;多行合并脚注&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$textRun2</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>,<span style="color:#ff5c57">$cellColSpan</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextRun</span>(<span style="color:#ff5c57">$cellHCentered</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$textRun2</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;B&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$textRun2</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addFootnote</span>()<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;多列合并脚注&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>,<span style="color:#ff5c57">$cellRowSpan</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;E&#39;</span>,<span style="color:#ff6ac1">null</span>,<span style="color:#ff5c57">$cellHCentered</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 第二行
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addRow</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff6ac1">null</span>, <span style="color:#ff5c57">$cellRowContinue</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>, <span style="color:#ff5c57">$cellVCentered</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;C&#39;</span>, <span style="color:#ff6ac1">null</span>, <span style="color:#ff5c57">$cellHCentered</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>, <span style="color:#ff5c57">$cellVCentered</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;D&#39;</span>, <span style="color:#ff6ac1">null</span>, <span style="color:#ff5c57">$cellHCentered</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff6ac1">null</span>, <span style="color:#ff5c57">$cellRowContinue</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 3) 跨 行 与 列 END
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>(<span style="color:#ff9f43">2</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 4) 同时合并 行 与 列 BGN
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTitle</span>(<span style="color:#5af78e">&#39;同时合并行与列&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>(<span style="color:#ff9f43">2</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$styleTable</span> <span style="color:#ff6ac1">=</span> [<span style="color:#5af78e">&#39;borderSize&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">6</span>, <span style="color:#5af78e">&#39;borderColor&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;999999&#39;</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTableStyle</span>(<span style="color:#5af78e">&#39;Colspan Rowspan&#39;</span>, <span style="color:#ff5c57">$styleTable</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTable</span>(<span style="color:#5af78e">&#39;Colspan Rowspan&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$row</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addRow</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$row</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>, [<span style="color:#5af78e">&#39;vMerge&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;restart&#39;</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;A&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$row</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>, [<span style="color:#5af78e">&#39;gridSpan&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">2</span>, <span style="color:#5af78e">&#39;vMerge&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;restart&#39;</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;B&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$row</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;1&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$row</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addRow</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$row</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>, [<span style="color:#5af78e">&#39;vMerge&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;continue&#39;</span>]);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$row</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>, [<span style="color:#5af78e">&#39;gridSpan&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">2</span>,<span style="color:#5af78e">&#39;vMerge&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;continue&#39;</span>]);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$row</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;2&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$row</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addRow</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$row</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>, [<span style="color:#5af78e">&#39;vMerge&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;continue&#39;</span>]);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$row</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;C&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$row</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;D&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$row</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;3&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 4) 同时合并 行 与 列 END
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>(<span style="color:#ff9f43">2</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 5) 嵌套表格 BGN
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTitle</span>(<span style="color:#5af78e">&#39;嵌套表格&#39;</span>,<span style="color:#ff9f43">1</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>(<span style="color:#ff9f43">2</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTable</span>([
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;width&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">50</span> <span style="color:#ff6ac1">*</span> <span style="color:#ff9f43">50</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;borderSize&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">10</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;unit&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;pct&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;alignment&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Jc<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">CENTER</span>
</span></span><span style="display:flex;"><span>]);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$cell</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addRow</span>()<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>,[<span style="color:#5af78e">&#39;bgColor&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;990000&#39;</span>]);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$cell</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;第一层表格&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$innerCell</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$cell</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTable</span>([<span style="color:#5af78e">&#39;alignment&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Jc<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">CENTER</span>,<span style="color:#5af78e">&#39;borderSize&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">8</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addRow</span>()<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>,[<span style="color:#5af78e">&#39;bgColor&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;FFFF00&#39;</span>]);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$innerCell</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;第二层表格&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 5) 嵌套表格 END
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>(<span style="color:#ff9f43">2</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 6) 浮动定位表格 BGN
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTitle</span>(<span style="color:#5af78e">&#39;浮动定位表格&#39;</span>,<span style="color:#ff9f43">1</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTable</span>([<span style="color:#5af78e">&#39;borderSize&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">6</span>, <span style="color:#5af78e">&#39;borderColor&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;009999&#39;</span>, <span style="color:#5af78e">&#39;position&#39;</span> <span style="color:#ff6ac1">=&gt;</span> [<span style="color:#5af78e">&#39;vertAnchor&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Style\TablePosition<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">VANCHOR_TEXT</span>]]);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextBreak</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$cell</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addRow</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$cell</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addRow</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$cell</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addRow</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(<span style="color:#ff5c57">$cellHeight</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 6) 浮动定位表格 END
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 生成文件
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>IOFactory<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">createWriter</span>(<span style="color:#ff5c57">$phpWord</span>,<span style="color:#5af78e">&#39;Word2007&#39;</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">save</span>(<span style="color:#ff5c57">$this</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">file_path</span><span style="color:#ff6ac1">.</span><span style="color:#5af78e">&#39;table.docx&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">echo</span> <span style="color:#5af78e">&#39;success&#39;</span>;
</span></span></code></pre></div><p><img src="/phpword/img/phpword_simple_table.png"
	width="794"
	height="726"
	srcset="/phpword/img/phpword_simple_table_huccd731e2a72395bfa10d92a3d4a4a3a7_42360_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/phpword_simple_table_huccd731e2a72395bfa10d92a3d4a4a3a7_42360_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="PHPWord Simple Table"
	
	
		class="gallery-image" 
		data-flex-grow="109"
		data-flex-basis="262px"
	
></p>
<p><img src="/phpword/img/phpword_cols_table.png"
	width="793"
	height="556"
	srcset="/phpword/img/phpword_cols_table_huf38638110da8f790981dfa2d833534b0_22095_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/phpword_cols_table_huf38638110da8f790981dfa2d833534b0_22095_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="PHPWord Cols Table"
	
	
		class="gallery-image" 
		data-flex-grow="142"
		data-flex-basis="342px"
	
></p>
<p><img src="/phpword/img/phpword_wrap_table.png"
	width="789"
	height="283"
	srcset="/phpword/img/phpword_wrap_table_hub3223ae88f10a846e4996adca7069d73_14621_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/phpword_wrap_table_hub3223ae88f10a846e4996adca7069d73_14621_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="PHPWord Wrap Table"
	
	
		class="gallery-image" 
		data-flex-grow="278"
		data-flex-basis="669px"
	
></p>
<blockquote>
<p>表格 浮动定位 配置 为 相对于 页面时 wps 与 word 显示不一致【不兼容】</p>
</blockquote>
<h3 id="模板处理">模板处理</h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff5c57">$templateFile</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$this</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">file_path</span> <span style="color:#ff6ac1">.</span> <span style="color:#5af78e">&#39;template.docx&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$savePath</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$this</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">file_path</span> <span style="color:#ff6ac1">.</span> <span style="color:#5af78e">&#39;template_output.docx&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$logoPath</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$this</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">img_path</span> <span style="color:#ff6ac1">.</span> <span style="color:#5af78e">&#39;cat.png&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$templateProcessor</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">new</span> TemplateProcessor(<span style="color:#ff5c57">$templateFile</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 1) 设置 宏 搜索 开始 与 结束 符号 BGN
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// $templateProcessor-&gt;setMacroChars(&#39;{#&#39;,&#39;#}&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// 1) 设置 宏 搜索 开始 与 结束 符号 END
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 2) 设置 单行值 BGN
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$templateProcessor</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setValue</span>(<span style="color:#5af78e">&#39;name&#39;</span>,<span style="color:#5af78e">&#39;申通通&#39;</span>); <span style="color:#78787e">// 姓名
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$templateProcessor</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setValues</span>([ <span style="color:#5af78e">&#39;province&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;山西省&#39;</span>, <span style="color:#5af78e">&#39;city&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;临汾市&#39;</span>, <span style="color:#5af78e">&#39;country&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;洪洞县&#39;</span>]);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$templateProcessor</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setImageValue</span>(<span style="color:#5af78e">&#39;logo&#39;</span>,<span style="color:#ff6ac1">array</span>(<span style="color:#5af78e">&#39;path&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff5c57">$logoPath</span>, <span style="color:#5af78e">&#39;width&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">100</span>, <span style="color:#5af78e">&#39;height&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">100</span>, <span style="color:#5af78e">&#39;ratio&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">false</span>)); <span style="color:#78787e">// 头像*/
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#78787e">/*$templateProcessor-&gt;setImageValue(&#39;logo&#39;,function(){
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">    return file_get_contents($this-&gt;img_path.&#39;cat.png&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">});*/</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// $templateProcessor-&gt;setValues([&#39;province&#39; =&gt; &#39;山西省&#39;,&#39;city&#39; =&gt; &#39;临汾市&#39;,&#39;country&#39; =&gt; &#39;洪洞县&#39;]); // 籍贯
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// 2) 设置 单行值 END
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 3) 克隆、替换 块内容 BGN
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$templateProcessor</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">cloneBlock</span>(<span style="color:#5af78e">&#39;familyMembers&#39;</span>,<span style="color:#ff9f43">2</span>,<span style="color:#ff6ac1">true</span>,<span style="color:#ff6ac1">false</span>,[
</span></span><span style="display:flex;"><span>    [<span style="color:#5af78e">&#39;memberName&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;张三&#39;</span>,<span style="color:#5af78e">&#39;memberRelation&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;哥哥&#39;</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#5af78e">&#39;memberName&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;李四&#39;</span>,<span style="color:#5af78e">&#39;memberRelation&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;妹妹&#39;</span>],
</span></span><span style="display:flex;"><span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// todo:替换块内容、待测试
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$templateProcessor</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">replaceBlock</span>(<span style="color:#5af78e">&#39;sloganContent&#39;</span>,<span style="color:#5af78e">&#39;replace content&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 3) 克隆、替换 块内容 END
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 4) 删除块内容 BGN
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$templateProcessor</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">deleteBlock</span>(<span style="color:#5af78e">&#39;deleteBlock&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 4) 删除块内容 END
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 5) 克隆行 并 设置内容 BGN
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// $templateProcessor-&gt;cloneRow(&#39;relationUserid&#39;,2);
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$templateProcessor</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">cloneRowAndSetValues</span>(<span style="color:#5af78e">&#39;relationUserid&#39;</span>,[
</span></span><span style="display:flex;"><span>    [<span style="color:#5af78e">&#39;relationUserid&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">1</span>, <span style="color:#5af78e">&#39;relation_username&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;刘亦菲&#39;</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#5af78e">&#39;relationUserid&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">2</span>, <span style="color:#5af78e">&#39;relation_username&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;张三丰&#39;</span>],
</span></span><span style="display:flex;"><span>]);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 5) 克隆行 并 设置内容 END
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 6) 添加 Xsl样式 文件 BGN
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$XslDomDocument</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">new</span> DOMDocument(<span style="color:#5af78e">&#34;1.0&#34;</span>,<span style="color:#5af78e">&#34;UTF-8&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$XslDomDocument</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">load</span>(<span style="color:#ff5c57">$this</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">file_path</span><span style="color:#ff6ac1">.</span><span style="color:#5af78e">&#39;template.xsl&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$templateProcessor</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">applyXslStyleSheet</span>(<span style="color:#ff5c57">$XslDomDocument</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 6) 添加 Xsl样式 文件 END
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 7) 替换复杂文本内容【带样式】 BGN
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$title</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">new</span> TextRun();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$title</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;关于php我想说两点..&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$templateProcessor</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setComplexBlock</span>(<span style="color:#5af78e">&#39;title&#39;</span>,<span style="color:#ff5c57">$title</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$inline</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">new</span> TextRun();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$inline</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;世界上最好的语言&#39;</span>,[<span style="color:#5af78e">&#39;bold&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>, <span style="color:#5af78e">&#39;italic&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>, <span style="color:#5af78e">&#39;color&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;red&#39;</span>]);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$templateProcessor</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setComplexValue</span>(<span style="color:#5af78e">&#39;inline&#39;</span>,<span style="color:#ff5c57">$inline</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$field</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">new</span> Field(<span style="color:#5af78e">&#39;DATE&#39;</span>, [<span style="color:#5af78e">&#39;dateformat&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;M/d/yyyy h:mm:ss&#39;</span>], [<span style="color:#5af78e">&#39;PreserveFormat&#39;</span>]);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$templateProcessor</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setComplexValue</span>(<span style="color:#5af78e">&#39;date&#39;</span>, <span style="color:#ff5c57">$field</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 7) 替换复杂文本内容【带样式】 END
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 8) 设置复杂块 BGN
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$table</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">new</span> Table([<span style="color:#5af78e">&#39;borderSize&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">12</span>, <span style="color:#5af78e">&#39;borderColor&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;green&#39;</span>, <span style="color:#5af78e">&#39;width&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Converter<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">pixelToTwip</span>(<span style="color:#ff9f43">400</span>), <span style="color:#5af78e">&#39;unit&#39;</span> <span style="color:#ff6ac1">=&gt;</span> TblWidth<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">TWIP</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addRow</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(Converter<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">pixelToTwip</span>(<span style="color:#ff9f43">50</span>),[<span style="color:#5af78e">&#39;valign&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;center&#39;</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextRun</span>([<span style="color:#5af78e">&#39;alignment&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Jc<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">CENTER</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;语文&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(Converter<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">pixelToTwip</span>(<span style="color:#ff9f43">50</span>),[<span style="color:#5af78e">&#39;valign&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;center&#39;</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextRun</span>([<span style="color:#5af78e">&#39;alignment&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Jc<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">CENTER</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;数学&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(Converter<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">pixelToTwip</span>(<span style="color:#ff9f43">50</span>),[<span style="color:#5af78e">&#39;valign&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;center&#39;</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextRun</span>([<span style="color:#5af78e">&#39;alignment&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Jc<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">CENTER</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;英语&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(Converter<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">pixelToTwip</span>(<span style="color:#ff9f43">50</span>),[<span style="color:#5af78e">&#39;valign&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;center&#39;</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextRun</span>([<span style="color:#5af78e">&#39;alignment&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Jc<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">CENTER</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;物理&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addRow</span>();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(Converter<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">pixelToTwip</span>(<span style="color:#ff9f43">50</span>),[<span style="color:#5af78e">&#39;valign&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;center&#39;</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextRun</span>([<span style="color:#5af78e">&#39;alignment&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Jc<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">CENTER</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#ff9f43">88</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(Converter<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">pixelToTwip</span>(<span style="color:#ff9f43">50</span>),[<span style="color:#5af78e">&#39;valign&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;center&#39;</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextRun</span>([<span style="color:#5af78e">&#39;alignment&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Jc<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">CENTER</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#ff9f43">78</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(Converter<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">pixelToTwip</span>(<span style="color:#ff9f43">50</span>),[<span style="color:#5af78e">&#39;valign&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;center&#39;</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextRun</span>([<span style="color:#5af78e">&#39;alignment&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Jc<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">CENTER</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#ff9f43">79</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$table</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addCell</span>(Converter<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">pixelToTwip</span>(<span style="color:#ff9f43">50</span>),[<span style="color:#5af78e">&#39;valign&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;center&#39;</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTextRun</span>([<span style="color:#5af78e">&#39;alignment&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Jc<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">CENTER</span>])<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#ff9f43">98</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$templateProcessor</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setComplexBlock</span>(<span style="color:#5af78e">&#39;table&#39;</span>,<span style="color:#ff5c57">$table</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 8) 设置复杂块 END
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 9) 添加图表值 BGN
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$chartStyle</span> <span style="color:#ff6ac1">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;width&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Converter<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">inchToEmu</span>(<span style="color:#ff9f43">5.5</span>), <span style="color:#78787e">// 英寸 =&gt; EMU
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;height&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Converter<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">inchToEmu</span>(<span style="color:#ff9f43">5</span>),
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;title&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;各班级科目及格人数统计表&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;showLegend&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>, <span style="color:#78787e">// 是否显示 解释性 描述 标签【例如 颜色 与 班级 的 对应关系】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;showAxisLabels&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>, <span style="color:#78787e">// 是否显示 X、Y 轴的分类与数值名称
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;legendPosition&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;tr&#39;</span>, <span style="color:#78787e">// 解释性 描述 标签 的 位置【r=&gt;right、b=&gt;bottom、t=&gt;图表上方、l=&gt;图表左边、tr=&gt;图表右上方】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;dataLabelOptions&#39;</span> <span style="color:#ff6ac1">=&gt;</span> ([  <span style="color:#78787e">// 数据标签 配置
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>        <span style="color:#5af78e">&#39;showVal&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>,          <span style="color:#78787e">// Y 轴是否显示 具体数值
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>        <span style="color:#5af78e">&#39;showCatName&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">false</span>,     <span style="color:#78787e">// 是否显示分类名称
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    ]),
</span></span><span style="display:flex;"><span>];
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$categories</span> <span style="color:#ff6ac1">=</span> [<span style="color:#5af78e">&#39;语文&#39;</span>,<span style="color:#5af78e">&#39;数学&#39;</span>,<span style="color:#5af78e">&#39;英语&#39;</span>,<span style="color:#5af78e">&#39;物理&#39;</span>,<span style="color:#5af78e">&#39;化学&#39;</span>,<span style="color:#5af78e">&#39;生物&#39;</span>,<span style="color:#5af78e">&#39;政治&#39;</span>,<span style="color:#5af78e">&#39;历史&#39;</span>,<span style="color:#5af78e">&#39;地理&#39;</span>];
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$class1</span> <span style="color:#ff6ac1">=</span> [<span style="color:#ff9f43">88</span>,<span style="color:#ff9f43">64</span>,<span style="color:#ff9f43">75</span>,<span style="color:#ff9f43">76</span>,<span style="color:#ff9f43">55</span>,<span style="color:#ff9f43">67</span>,<span style="color:#ff9f43">88</span>,<span style="color:#ff9f43">80</span>,<span style="color:#ff9f43">79</span>]; <span style="color:#78787e">// 1 班 各科目 及格 的人数
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$class2</span> <span style="color:#ff6ac1">=</span> [<span style="color:#ff9f43">85</span>,<span style="color:#ff9f43">78</span>,<span style="color:#ff9f43">66</span>,<span style="color:#ff9f43">78</span>,<span style="color:#ff9f43">48</span>,<span style="color:#ff9f43">59</span>,<span style="color:#ff9f43">67</span>,<span style="color:#ff9f43">77</span>,<span style="color:#ff9f43">53</span>]; <span style="color:#78787e">// 2 班 各科目 及格 的人数
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$chart</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">new</span> Chart(<span style="color:#5af78e">&#39;column&#39;</span>,<span style="color:#ff5c57">$categories</span>,<span style="color:#ff5c57">$class1</span>,<span style="color:#ff5c57">$chartStyle</span>,<span style="color:#5af78e">&#39;01班&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$chart</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addSeries</span>(<span style="color:#ff5c57">$categories</span>,<span style="color:#ff5c57">$class2</span>,<span style="color:#5af78e">&#39;02班&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$templateProcessor</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setChart</span>(<span style="color:#5af78e">&#39;column&#39;</span>,<span style="color:#ff5c57">$chart</span>);
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 9) 添加图表值 END
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 保存文件到 $savePath 路径
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$templateProcessor</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">saveAs</span>(<span style="color:#ff5c57">$savePath</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">echo</span> <span style="color:#5af78e">&#39;success&#39;</span>;
</span></span></code></pre></div><p>示例：<a class="link" href="file/template.docx"  title="Template"
    >Download Template</a>     <a class="link" href="file/template_output.docx"  title="Output Template"
    >Output Template</a></p>
<blockquote>
<p>关于 Xsl：https://www.runoob.com/xsl/xsl-tutorial.html</p>
</blockquote>
<h2 id="图表">图表</h2>
<h3 id="图表配置项">图表配置项</h3>
<style>
.shape {
    width: 220px;
    height: 200px;
}

table tr td img {
    width: 400px;
    height: 400px;
}
table tr td {
    text-align: center;
}
</style>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>是否支持3D</th>
</tr>
</thead>
<tbody>
<tr>
<td><br>pie【饼图】</td>
<td><img src='img/shape/phpword_shape_pie.jpg' class='shape'></td>
<td><img src='img/shape/phpword_shape_pie_3d.jpg'></td>
</tr>
<tr>
<td><br>doughnut【圆环图】</td>
<td><img src='img/shape/phpword_shape_doughnut.jpg' class='shape'></td>
<td><br><br><center>否</center></td>
</tr>
<tr>
<td><br>bar【柱状图】</td>
<td><br><img src='img/shape/phpword_shape_bar.jpg' class='shape'></td>
<td><img src='img/shape/phpword_shape_bar_3d.jpg' class='shape'></td>
</tr>
<tr>
<td><br>column【与bar方向不同】</td>
<td><br><img src='img/shape/phpword_shape_column.jpg' class='shape'></td>
<td><img src='img/shape/phpword_shape_column_3d.jpg' class='shape'></td>
</tr>
<tr>
<td><br>line【折线图】</td>
<td><br><img src='img/shape/phpword_shape_line.jpg' class='shape'></td>
<td><br><img src='img/shape/phpword_shape_line_3d.jpg' class='shape'></td>
</tr>
<tr>
<td><br>area【区域图】与折线图类似，区别是填充了空白区域</td>
<td><img src='img/shape/phpword_shape_area.jpg' class='shape'></td>
<td><img src='img/shape/phpword_shape_area_3d.jpg' class='shape'></td>
</tr>
<tr>
<td><br>scatter【散点图】</td>
<td><img src='img/shape/phpword_shape_scatter.jpg' class='shape'></td>
<td><br><center>否</center></td>
</tr>
<tr>
<td><br>radar【雷达图】</td>
<td><img src='img/shape/phpword_shape_radar.jpg' class='shape'></td>
<td><br><center>否</center></td>
</tr>
<tr>
<td><br>stacked_bar【堆叠柱状图】</td>
<td><img src='img/shape/phpword_shape_stacked_bar.jpg' class='shape'></td>
<td><br><center>否</center></td>
</tr>
<tr>
<td><br>percent_stacked_bar【百分比堆叠柱状图】</td>
<td><img src='img/shape/phpword_shape_percent_stacked_bar.jpg' class='shape'></td>
<td><br><center>否</center></td>
</tr>
<tr>
<td><br>stacked_column【堆叠列图】与 堆叠柱状图 类似，方向不一致</td>
<td><img src='img/shape/phpword_shape_stacked_column.jpg' class='shape'></td>
<td><br><center>否</center></td>
</tr>
<tr>
<td><br>percent_stacked_column【百分比堆叠列图】</td>
<td><img src='img/shape/phpword_shape_percent_stacked_column.jpg' class='shape'></td>
<td><br><center>否</center></td>
</tr>
</tbody>
</table></div>
<h3 id="生成图表">生成图表</h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#78787e">// 分类
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$categories</span> <span style="color:#ff6ac1">=</span> [<span style="color:#5af78e">&#39;Chinese&#39;</span>,<span style="color:#5af78e">&#39;Math&#39;</span>,<span style="color:#5af78e">&#39;English&#39;</span>,<span style="color:#5af78e">&#39;Physical&#39;</span>,<span style="color:#5af78e">&#39;Chemical&#39;</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 数据
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$class1Name</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#39;1班&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$class1</span> <span style="color:#ff6ac1">=</span> [<span style="color:#ff9f43">1</span>,<span style="color:#ff9f43">3</span>,<span style="color:#ff9f43">2</span>,<span style="color:#ff9f43">5</span>,<span style="color:#ff9f43">4</span>];
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$class2Name</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#39;2班&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$class2</span> <span style="color:#ff6ac1">=</span> [<span style="color:#ff9f43">3</span>,<span style="color:#ff9f43">1</span>,<span style="color:#ff9f43">7</span>,<span style="color:#ff9f43">2</span>,<span style="color:#ff9f43">6</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 图表 样式
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$chartStyles</span> <span style="color:#ff6ac1">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;width&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Converter<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">inchToEmu</span>(<span style="color:#ff9f43">5.5</span>), <span style="color:#78787e">// 英寸 =&gt; EMU
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;height&#39;</span> <span style="color:#ff6ac1">=&gt;</span> Converter<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">inchToEmu</span>(<span style="color:#ff9f43">5</span>),
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;colors&#39;</span> <span style="color:#ff6ac1">=&gt;</span> [   <span style="color:#78787e">// 指定图表颜色
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>        <span style="color:#5af78e">&#39;FF0000&#39;</span>, <span style="color:#78787e">// 红色
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>        <span style="color:#5af78e">&#39;00FF00&#39;</span>, <span style="color:#78787e">// 绿色
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>        <span style="color:#5af78e">&#39;0000FF&#39;</span>, <span style="color:#78787e">// 蓝色
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    ],
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;3d&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>, <span style="color:#78787e">// 是否为 3d 图形
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;title&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;成绩图示&#39;</span>, <span style="color:#78787e">// 图表 标题
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;showLegend&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>, <span style="color:#78787e">// 是否显示 解释性 描述 标签【例如 颜色 与 班级 的 对应关系】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;legendPosition&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff5c57">$legendPos</span>, <span style="color:#78787e">// 解释性 描述 标签 的 位置【r=&gt;right、b=&gt;bottom、t=&gt;图表上方、l=&gt;图表左边、tr=&gt;图表右上方】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;showAxisLabels&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>, <span style="color:#78787e">// 是否显示 X、Y 轴的分类与数值名称
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;dataLabelOptions&#39;</span> <span style="color:#ff6ac1">=&gt;</span> ([  <span style="color:#78787e">// 数据标签 配置
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>        <span style="color:#5af78e">&#39;showVal&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>,          <span style="color:#78787e">// 是否显示 分数 具体数值
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>        <span style="color:#5af78e">&#39;showCatName&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">false</span>,     <span style="color:#78787e">// 是否显示分类名称
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>        <span style="color:#5af78e">&#39;showLegendKey&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>,    <span style="color:#78787e">// 是否显示图例标记
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>        <span style="color:#5af78e">&#39;showSerName&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">false</span>,     <span style="color:#78787e">// 是否显示系列名称
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>        <span style="color:#5af78e">&#39;showPercent&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">false</span>,     <span style="color:#78787e">// 是否显示百分比【适用于 饼图】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>        <span style="color:#5af78e">&#39;showLeaderLines&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">false</span>, <span style="color:#78787e">// 是否显示引导线【适用于 折线图】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>        <span style="color:#5af78e">&#39;showBubbleSize&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">false</span>,  <span style="color:#78787e">// 是否显示数据点大小【适用于 散点图、气泡图等 标识数据 的 规模 或 权重 场景】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    ]),
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;showGridY&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>, <span style="color:#78787e">// 是否显示 Y 轴网格线
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;showGridX&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>, <span style="color:#78787e">// 是否显示 X 轴网格线
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;categoryLabelPosition&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;low&#39;</span>, <span style="color:#78787e">// 分类 名称的位置【nextTo、low、high】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;valueLabelPosition&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;nextTo&#39;</span>,  <span style="color:#78787e">// 数值 的 位置【nextTo、low、high】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;categoryAxisTitle&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;科目&#39;</span>, <span style="color:#78787e">// 分类轴的标题【x轴】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;valueAxisTitle&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;成绩&#39;</span>, <span style="color:#78787e">// 数值轴的标题【y轴】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>    <span style="color:#5af78e">&#39;majorTickPosition&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;in&#39;</span>, <span style="color:#78787e">// 刻度标记的位置【in、out、cross、none】
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 添加图表 $chartType 对应 3.2.1 中的 参数
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$chart</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addChart</span>(<span style="color:#ff5c57">$chartType</span>,<span style="color:#ff5c57">$categories</span>,<span style="color:#ff5c57">$class1</span>,<span style="color:#ff5c57">$chartStyles</span>,<span style="color:#ff5c57">$class1Name</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$chart</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addSeries</span>(<span style="color:#ff5c57">$categories</span>,<span style="color:#ff5c57">$class2</span>,<span style="color:#ff5c57">$class2Name</span>); <span style="color:#78787e">// 添加 其他数值
</span></span></span></code></pre></div><blockquote>
<p>生成的 3d 图表 在 wps 中无法正常显示，office中可以【我 wps 版本是 2019】</p>
</blockquote>
<h2 id="读取-word-内容">读取 Word 内容</h2>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff6ac1">&lt;?</span>php
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">namespace</span> app\index\controller;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">use</span> think\facade\Env;
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">use</span> think\Controller;
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">use</span> PhpOffice\PhpWord\IOFactory;
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">use</span> PhpOffice\PhpWord\Element\AbstractContainer;
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">use</span> PhpOffice\PhpWord\Element\Row;
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">use</span> PhpOffice\PhpWord\Element\Section;
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">use</span> PhpOffice\PhpWord\Element\TextRun;
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">use</span> PhpOffice\PhpWord\Element\Text;
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">use</span> PhpOffice\PhpWord\Element\Table;
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">use</span> PhpOffice\PhpWord\Element\Link;
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">use</span> PhpOffice\PhpWord\Element\Footnote;
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">use</span> PhpOffice\PhpWord\Element\Image;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">class</span> <span style="color:#f3f99d">Office</span> <span style="color:#ff6ac1">extends</span> Controller
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">public</span> <span style="color:#ff6ac1">function</span> <span style="color:#57c7ff">parse</span>()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#ff5c57">$doc</span> <span style="color:#ff6ac1">=</span> Env<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">get</span>(<span style="color:#5af78e">&#39;root_path&#39;</span>) <span style="color:#ff6ac1">.</span> <span style="color:#5af78e">&#39;public/static/file/template_output.docx&#39;</span>; <span style="color:#78787e">// 文档路径
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>            <span style="color:#ff5c57">$phpWord</span> <span style="color:#ff6ac1">=</span> IOFactory<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">createReader</span>(<span style="color:#5af78e">&#39;Word2007&#39;</span>)<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">load</span>(<span style="color:#ff5c57">$doc</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#ff5c57">$documentContent</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$this</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getAllElements</span>(<span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getSections</span>());
</span></span><span style="display:flex;"><span>            p(<span style="color:#ff5c57">$documentContent</span>);
</span></span><span style="display:flex;"><span>        } <span style="color:#ff6ac1">catch</span> (\Exception <span style="color:#ff5c57">$e</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#78787e">// 处理异常情况
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>            <span style="color:#ff6ac1">echo</span> <span style="color:#5af78e">&#39;Error occurred: &#39;</span> <span style="color:#ff6ac1">.</span> <span style="color:#ff5c57">$e</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getMessage</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">     * @param Section[] $sections
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">     * @return array
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">private</span> <span style="color:#ff6ac1">function</span> <span style="color:#57c7ff">getAllElements</span>(<span style="color:#ff6ac1">array</span> <span style="color:#ff5c57">$sections</span>)<span style="color:#ff6ac1">:</span> <span style="color:#ff6ac1">array</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">$allElements</span> <span style="color:#ff6ac1">=</span> [];
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">foreach</span> (<span style="color:#ff5c57">$sections</span> <span style="color:#ff6ac1">as</span> <span style="color:#ff5c57">$section</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#ff5c57">$this</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">collectElements</span>(<span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getElements</span>(), <span style="color:#ff5c57">$allElements</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">return</span> <span style="color:#ff5c57">$allElements</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">     * @param Element[] $elements
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">     * @param array $allElements
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">     * @return void
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">private</span> <span style="color:#ff6ac1">function</span> <span style="color:#57c7ff">collectElements</span>(<span style="color:#ff6ac1">array</span> <span style="color:#ff5c57">$elements</span>, <span style="color:#ff6ac1">array</span> <span style="color:#ff6ac1">&amp;</span><span style="color:#ff5c57">$allElements</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">foreach</span> (<span style="color:#ff5c57">$elements</span> <span style="color:#ff6ac1">as</span> <span style="color:#ff5c57">$element</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#ff6ac1">if</span> (<span style="color:#ff5c57">$element</span> instanceof Text) {
</span></span><span style="display:flex;"><span>                <span style="color:#ff5c57">$allElements</span>[] <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$element</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getText</span>();
</span></span><span style="display:flex;"><span>            } <span style="color:#ff6ac1">else</span> <span style="color:#ff6ac1">if</span> (<span style="color:#ff5c57">$element</span> instanceof TextRun <span style="color:#ff6ac1">||</span> <span style="color:#ff5c57">$element</span> instanceof Image) {
</span></span><span style="display:flex;"><span>                <span style="color:#ff5c57">$allElements</span>[] <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$this</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getElements</span>(<span style="color:#ff5c57">$element</span>);
</span></span><span style="display:flex;"><span>            } <span style="color:#ff6ac1">else</span> <span style="color:#ff6ac1">if</span> (<span style="color:#ff5c57">$element</span> instanceof Table) {
</span></span><span style="display:flex;"><span>                <span style="color:#ff5c57">$data</span> <span style="color:#ff6ac1">=</span> [];
</span></span><span style="display:flex;"><span>                <span style="color:#ff5c57">$this</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getTables</span>(<span style="color:#ff5c57">$element</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getRows</span>(), <span style="color:#ff5c57">$data</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#ff5c57">$allElements</span>[] <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$data</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">     * @param AbstractContainer $abstractContainer
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">     * @return string
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">private</span> <span style="color:#ff6ac1">function</span> <span style="color:#57c7ff">getElements</span>(AbstractContainer <span style="color:#ff5c57">$abstractContainer</span>)<span style="color:#ff6ac1">:</span> string
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">$text</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#39;&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">foreach</span> (<span style="color:#ff5c57">$abstractContainer</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getElements</span>() <span style="color:#ff6ac1">as</span> <span style="color:#ff5c57">$element</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#ff6ac1">if</span> (<span style="color:#ff5c57">$element</span> instanceof Text) {
</span></span><span style="display:flex;"><span>                <span style="color:#ff5c57">$text</span> <span style="color:#ff6ac1">.=</span> <span style="color:#ff5c57">$element</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getText</span>();
</span></span><span style="display:flex;"><span>            } <span style="color:#ff6ac1">else</span> <span style="color:#ff6ac1">if</span> (<span style="color:#ff5c57">$element</span> instanceof TextRun) {
</span></span><span style="display:flex;"><span>                <span style="color:#ff5c57">$text</span> <span style="color:#ff6ac1">.=</span> <span style="color:#ff5c57">$this</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getElements</span>(<span style="color:#ff5c57">$element</span>);
</span></span><span style="display:flex;"><span>            } <span style="color:#ff6ac1">else</span> <span style="color:#ff6ac1">if</span> (<span style="color:#ff5c57">$element</span> instanceof Image) {
</span></span><span style="display:flex;"><span>                <span style="color:#78787e">// $text .= $element-&gt;getImageString(); // 获取二进制格式的数据流
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>                <span style="color:#ff5c57">$text</span> <span style="color:#ff6ac1">.=</span> <span style="color:#ff5c57">$element</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getImageStringData</span>(<span style="color:#ff6ac1">true</span>);
</span></span><span style="display:flex;"><span>            } <span style="color:#ff6ac1">else</span> <span style="color:#ff6ac1">if</span> (<span style="color:#ff5c57">$element</span> instanceof Link) {
</span></span><span style="display:flex;"><span>                <span style="color:#ff5c57">$text</span> <span style="color:#ff6ac1">.=</span> <span style="color:#ff5c57">$element</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getSource</span>(<span style="color:#ff6ac1">true</span>);
</span></span><span style="display:flex;"><span>            } <span style="color:#ff6ac1">else</span> <span style="color:#ff6ac1">if</span> (<span style="color:#ff5c57">$element</span> instanceof Footnote) {
</span></span><span style="display:flex;"><span>                <span style="color:#ff5c57">$text</span> <span style="color:#ff6ac1">.=</span> <span style="color:#5af78e">&#39;&lt;--footnote--&#39;</span> <span style="color:#ff6ac1">.</span> <span style="color:#ff5c57">$this</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getElements</span>(<span style="color:#ff5c57">$element</span>) <span style="color:#ff6ac1">.</span> <span style="color:#5af78e">&#39;--footnote--&gt;&#39;</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">return</span> <span style="color:#ff5c57">$text</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">     * @param Row[] $rows
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">     * @param array $data
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">     * @return void
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">private</span> <span style="color:#ff6ac1">function</span> <span style="color:#57c7ff">getTables</span>(<span style="color:#ff6ac1">array</span> <span style="color:#ff5c57">$rows</span>, <span style="color:#ff6ac1">array</span> <span style="color:#ff6ac1">&amp;</span><span style="color:#ff5c57">$data</span>)<span style="color:#ff6ac1">:</span> void
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">foreach</span> (<span style="color:#ff5c57">$rows</span> <span style="color:#ff6ac1">as</span> <span style="color:#ff5c57">$row</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#ff5c57">$cells</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$row</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getCells</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#ff6ac1">foreach</span> (<span style="color:#ff5c57">$cells</span> <span style="color:#ff6ac1">as</span> <span style="color:#ff5c57">$cell</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#ff5c57">$elements</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$cell</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getElements</span>();
</span></span><span style="display:flex;"><span>                <span style="color:#ff6ac1">foreach</span> (<span style="color:#ff5c57">$elements</span> <span style="color:#ff6ac1">as</span> <span style="color:#ff5c57">$element</span>) {
</span></span><span style="display:flex;"><span>                    <span style="color:#ff6ac1">if</span> (<span style="color:#ff5c57">$element</span> instanceof TextRun) {
</span></span><span style="display:flex;"><span>                        <span style="color:#ff5c57">$data</span>[] <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$this</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getElements</span>(<span style="color:#ff5c57">$element</span>);
</span></span><span style="display:flex;"><span>                    } <span style="color:#ff6ac1">else</span> <span style="color:#ff6ac1">if</span> (<span style="color:#ff5c57">$element</span> instanceof Table) {
</span></span><span style="display:flex;"><span>                        <span style="color:#ff5c57">$this</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getTables</span>(<span style="color:#ff5c57">$element</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">getRows</span>(), <span style="color:#ff5c57">$data</span>);
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><img src="/phpword/img/phpword_reader.png"
	width="1229"
	height="908"
	srcset="/phpword/img/phpword_reader_hu7fbba0bb52c7b06f5b98150d1e689fd9_43625_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/phpword_reader_hu7fbba0bb52c7b06f5b98150d1e689fd9_43625_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="135"
		data-flex-basis="324px"
	
></p>
<p><img src="/phpword/img/phpword_reader_1.png"
	width="1121"
	height="168"
	srcset="/phpword/img/phpword_reader_1_huca113e71c3582a1857def99faa29f2c1_13584_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/phpword_reader_1_huca113e71c3582a1857def99faa29f2c1_13584_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="PHPWord Reader"
	
	
		class="gallery-image" 
		data-flex-grow="667"
		data-flex-basis="1601px"
	
></p>
<h2 id="问题">问题</h2>
<h3 id="页眉中不能添加标题">页眉中不能添加标题</h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#78787e">// 注册 标题 样式
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>Style<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">addTitleStyle</span>(<span style="color:#ff9f43">1</span>,[<span style="color:#5af78e">&#39;bold&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>,<span style="color:#5af78e">&#39;size&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">22</span>]);
</span></span><span style="display:flex;"><span>Style<span style="color:#ff6ac1">::</span><span style="color:#57c7ff">addTitleStyle</span>(<span style="color:#ff9f43">2</span>,[<span style="color:#5af78e">&#39;bold&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>,<span style="color:#5af78e">&#39;size&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff9f43">20</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addHeader</span>()<span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addTitle</span>(<span style="color:#5af78e">&#39;title&#39;</span>,<span style="color:#ff9f43">1</span>);
</span></span></code></pre></div><p><img src="/phpword/img/problem/phpword_header_title.png"
	width="1038"
	height="418"
	srcset="/phpword/img/problem/phpword_header_title_hue7cf358714824388eb05afd1c7462f52_45905_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/problem/phpword_header_title_hue7cf358714824388eb05afd1c7462f52_45905_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="PHPWord Header Title"
	
	
		class="gallery-image" 
		data-flex-grow="248"
		data-flex-basis="595px"
	
></p>
<h3 id="断字类型问题">断字类型问题</h3>
<h4 id="nextcolumn-问题">nextColumn 问题</h4>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff5c57">$section</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addSection</span>([<span style="color:#5af78e">&#39;breakType&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;nextColumn&#39;</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 错误用法
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;第一列内容&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;第二列内容&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">// 正确用法
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;第一列内容&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">$phpWord</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addSection</span>([<span style="color:#5af78e">&#39;breakType&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;nextColumn&#39;</span>]);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$section</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;第二列内容&#39;</span>);
</span></span></code></pre></div><p><img src="/phpword/img/problem/phpword_problem_breaktype.png"
	width="641"
	height="503"
	srcset="/phpword/img/problem/phpword_problem_breaktype_hu7fdf0d59cc538e9adb23ec0f4f16417f_9684_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/problem/phpword_problem_breaktype_hu7fdf0d59cc538e9adb23ec0f4f16417f_9684_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="PHPWord BreakType"
	
	
		class="gallery-image" 
		data-flex-grow="127"
		data-flex-basis="305px"
	
></p>
<h4 id="oddpage-与-evenpage-不生效问题1">oddPage 与 evenPage 不生效问题<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></h4>
<p><img src="/phpword/img/problem/phpword_odd_even_page.png"
	width="1151"
	height="519"
	srcset="/phpword/img/problem/phpword_odd_even_page_huc3a9497b97671ce3bddfa157c147e292_70925_480x0_resize_mitchellnetravali_3.png 480w, /phpword/img/problem/phpword_odd_even_page_huc3a9497b97671ce3bddfa157c147e292_70925_1024x0_resize_mitchellnetravali_3.png 1024w"
	loading="lazy"
	
		alt="PHPWord Odd Even Page"
	
	
		class="gallery-image" 
		data-flex-grow="221"
		data-flex-basis="532px"
	
></p>
<h3 id="模板替换问题">模板替换问题</h3>
<h4 id="块内容问题2">块内容问题<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup></h4>
<p>问题描述：无法通过 templateProcesser 对象 的 replaceBlock 实现块内容的替换</p>
<h4 id="替换连续文本问题">替换连续文本问题</h4>
<p>问题描述：无法 在 连续文本 中 添加 注释、链接 来 替换模板内容，如下代码</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff5c57">$test</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">new</span> TextRun();
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$test</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;关于&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$test</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;Python&#39;</span>,[<span style="color:#5af78e">&#39;color&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#5af78e">&#39;FF9999&#39;</span>,<span style="color:#5af78e">&#39;bold&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>,<span style="color:#5af78e">&#39;italic&#39;</span> <span style="color:#ff6ac1">=&gt;</span> <span style="color:#ff6ac1">true</span>]); <span style="color:#78787e">// 可以正常替换
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// $test-&gt;addLink(&#39;https://wwww.python.org&#39;,&#39;Python&#39;); // 不能替换
</span></span></span><span style="display:flex;"><span><span style="color:#78787e">// $test-&gt;addFootnote()-&gt;addText(&#39;人生苦短，我选择Python&#39;); // 不能替换
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">$test</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">addText</span>(<span style="color:#5af78e">&#39;是什么这件事&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">$templateProcessor</span><span style="color:#ff6ac1">-&gt;</span><span style="color:#57c7ff">setComplexValue</span>(<span style="color:#5af78e">&#39;test&#39;</span>,<span style="color:#ff5c57">$test</span>);
</span></span></code></pre></div><div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a class="link" href="https://github.com/PHPOffice/PHPWord/issues/1270"  target="_blank" rel="noopener"
    >https://github.com/PHPOffice/PHPWord/issues/1270</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p><a class="link" href="https://github.com/PHPOffice/PHPWord/issues/2410"  target="_blank" rel="noopener"
    >https://github.com/PHPOffice/PHPWord/issues/2410</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>true</span>
    </section>
    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>
    
</article>

    

    

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            1997 - 
        
        2024 
    </section>
    
    <section class="powerby">
        
            CopyRight © 1997-2023 技术沉淀库 All Rights Reserved 京ICP备 <br/>
        
        
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
